<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portfolio</title>
  <style>
    @font-face {
      font-family: 'Kaisei Decol';
      font-style: normal;
      font-weight: 400;
      font-display: swap;
      src: url('front/KaiseiDecol-Regular.ttf') format('truetype');
      unicode-range: U+0020-007E;
    }
    @font-face {
      font-family: 'Kaisei Decol';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url('front/KaiseiDecol-Medium.ttf') format('truetype');
      unicode-range: U+0020-007E;
    }
    @font-face {
      font-family: 'Kaisei Decol';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url('front/KaiseiDecol-Bold.ttf') format('truetype');
      unicode-range: U+0020-007E;
    }
    :root {
      --bg: linear-gradient(180deg, #e8f4fd 0%, #f5f9fc 35%, #fff8f0 70%, #fef5eb 100%);
      --bg-card: rgba(255, 255, 255, 0.85);
      --text: #1a1a2e;
      --text-muted: #5f6368;
      --accent: #f97316;
      --accent-blue: #0052D9;
      --gradient: linear-gradient(135deg, #0052D9 0%, #f97316 100%);
      --gradient-soft: linear-gradient(135deg, rgba(14, 165, 233, 0.1) 0%, rgba(249, 115, 22, 0.1) 100%);
      --border: rgba(0, 0, 0, 0.08);
      --radius: 16px;
      --radius-lg: 24px;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
      --shadow-hover: 0 12px 28px rgba(249, 115, 22, 0.12);
      --font: 'Kaisei Decol', SimHei, 'Microsoft YaHei', sans-serif;
      /* ç»Ÿä¸€ Art / Design / AI ä¸‰ä¸ªæ¨¡å—å†…å®¹åŒºåˆ° tab çš„é¡¶éƒ¨é—´è· */
      --tab-to-content: clamp(6rem, 12vw, 9rem);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html {
      scroll-behavior: smooth;
      overflow-x: hidden;
    }

    body {
      font-family: var(--font);
      background: var(--bg);
      background-attachment: scroll;
      background-size: 100% 100%;
      min-height: 100vh;
      width: 100%;
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
    }

    .page-wrap {
      flex: 1;
    }

    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      display: flex;
      justify-content: center;
      padding: clamp(0.75rem, 2vw, 1rem) clamp(1rem, 5vw, 2rem);
      pointer-events: none;
      background: transparent;
    }

    nav .nav-inner {
      pointer-events: auto;
      width: 100%;
      max-width: 1280px;
      margin: 0 auto;
      background: transparent;
      padding: 0.6rem 2.5rem;
      border-radius: 30px;
      transition: background 0.3s ease;
    }

    nav.nav-scrolled .nav-inner {
      background: rgba(255, 255, 255, 0.8);
    }

    nav ul {
      list-style: none;
      display: flex;
      justify-content: center;
      gap: clamp(1rem, 4vw, 2rem);
      flex-wrap: wrap;
    }

    nav a {
      color: #000;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
    }

    body.nav-bg-dark nav a.nav-active,
    body.nav-bg-dark nav a:hover { color: #fff; }
    body.nav-bg-white nav a.nav-active,
    body.nav-bg-white nav a:hover {
      color: #0052D9;
    }

    nav a.nav-active {
      font-weight: 600;
    }

    .hero {
      /* æ–‡æ¡ˆ/æŒ‰é’®ç›¸å¯¹æ’ç”»çš„å‚ç›´åç§»ï¼šè´Ÿå€¼è¶Šå¤§(å¦‚ -220px)è¶Šé è¿‘æ’ç”»ï¼Œè¶Šå°(å¦‚ -120px)ç¦»æ’ç”»è¶Šè¿œ */
      --hero-tagline-offset: -280px;
      /* AFUã€ZHANG ä¸æ’ç”»çš„å·¦å³é—´è·ï¼šå°å±çº¦ 0.15remï¼Œå¤§å±çº¦ 0.3remï¼Œä¸­é—´æŒ‰ 1vw å˜åŒ–ï¼›å¯æ”¹ä¸ºå…·ä½“æ•°å­—å¦‚ 8pxã€1rem ç­‰ */
      --hero-name-gap: clamp(0.15rem, 1vw, 0.3rem);
      min-height: 100vh;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: clamp(2rem, 4vw, 3rem) clamp(1rem, 4vw, 2rem);
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, #00ACF6 0%, #FFFFFF 95%);
      background-attachment: scroll;
    }
    .hero-bg {
      position: absolute;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }
    .hero-bg-layer {
      position: absolute;
      inset: 0;
      opacity: 0;
      background-attachment: scroll;
    }
    .hero-bg-1 { background: linear-gradient(180deg, #00ACF6 0%, #FFFFFF 95%); animation: heroBg1 24s ease-in-out infinite; }
    .hero-bg-2 { background: linear-gradient(180deg, #F67F00 0%, #FFFFFF 95%); animation: heroBg2 24s ease-in-out infinite; }
    .hero-bg-3 { background: linear-gradient(180deg, #00F6C9 0%, #FFFFFF 95%); animation: heroBg3 24s ease-in-out infinite; }
    .hero-bg-4 { background: linear-gradient(180deg, #3D07FF 0%, #FFFFFF 95%); animation: heroBg4 24s ease-in-out infinite; }
    @keyframes heroBg1 {
      0%, 8% { opacity: 1; }
      25% { opacity: 0; }
      83% { opacity: 0; }
      100% { opacity: 1; }
    }
    @keyframes heroBg2 {
      0%, 8% { opacity: 0; }
      25%, 33% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 0; }
    }
    @keyframes heroBg3 {
      0%, 33% { opacity: 0; }
      50%, 58% { opacity: 1; }
      75% { opacity: 0; }
      100% { opacity: 0; }
    }
    @keyframes heroBg4 {
      0%, 58% { opacity: 0; }
      75%, 83% { opacity: 1; }
      100% { opacity: 0; }
    }

    .hero::before {
      content: '';
      position: absolute;
      width: 100vw;
      height: 100%;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1;
      background: radial-gradient(ellipse 80% 60% at 50% 50%, rgba(0, 172, 246, 0.08) 0%, rgba(249, 115, 22, 0.06) 50%, transparent 70%);
      pointer-events: none;
    }

    .hero-center {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 0;
      width: 100%;
    }
    .hero-name-block {
      position: relative;
      z-index: 3;
      width: fit-content;
      max-width: min(1000px, 96vw);
    }
    .hero-name {
      position: absolute;
      top: 30%;
      transform: translateY(-50%);
      font-size: clamp(2rem, 8vw, 4.5rem);
      font-weight: 700;
      color: #000;
      letter-spacing: 0.02em;
      line-height: 1;
      white-space: nowrap;
    }
    .hero-name-left {
      right: 100%;
      margin-right: var(--hero-name-gap);
    }
    .hero-name-right {
      left: 100%;
      margin-left: var(--hero-name-gap);
    }
    .hero-name-mobile {
      display: none;
    }
    .hero-card-wrap {
      position: relative;
      z-index: 3;
      width: min(420px, 55vw);
    }
    .hero-illustration {
      display: block;
      width: 100%;
      height: auto;
      max-height: min(70vh, 560px);
      object-fit: contain;
      object-position: center;
      transform: scale(0.72) translateY(-50px);
    }

    .parallax-container {
      position: relative;
      display: block;
      width: 100%;
      height: min(70vh, 560px);
      max-height: min(70vh, 560px);
      overflow: hidden;
      transform: scale(0.72) translateY(-50px);
    }
    .parallax-container .layer-bg,
    .parallax-container .layer-character {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      object-position: center;
      pointer-events: none;
      transition: transform 0.1s ease-out;
    }
    .parallax-container .layer-bg { z-index: 0; }
    .parallax-container .layer-character { z-index: 1; }

    .hero-peek-stack {
      position: absolute;
      inset: 0;
      z-index: 2;
      pointer-events: auto;
    }

    .peek-card {
      position: absolute;
      inset: 0;
      z-index: 1;
      border: 1px solid rgba(0, 0, 0, 0.08);
      border-radius: 0;
      overflow: hidden;
      background: #fff;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      box-shadow: 0 18px 60px rgba(0, 0, 0, 0.08);
      opacity: 0;
      transform: translate(0, 0) rotate(0deg);
      transition: opacity 0.4s ease, transform 0.25s ease;
      cursor: pointer;
      padding: 0;
      pointer-events: none;
      appearance: none;
      -webkit-appearance: none;
      will-change: transform;
    }
    .hero-card-wrap.peek-revealed .peek-card {
      opacity: 1;
      pointer-events: auto;
    }
    .hero-card-wrap.peek-revealing .peek-card.peek-1 {
      transform: translate(28px, -24px) rotate(2deg);
    }
    .hero-card-wrap.peek-revealing .peek-card.peek-2 {
      transform: translate(44px, -16px) rotate(-2deg);
    }
    .hero-card-wrap.peek-revealing .peek-card.peek-3 {
      transform: translate(60px, 14px) rotate(1deg);
    }
    .peek-card img {
      position: relative;
      z-index: 1;
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      user-select: none;
      -webkit-user-drag: none;
    }

    .peek-card:not(.peek-loaded) .peek-placeholder {
      display: block;
    }
    .peek-card.peek-loaded .peek-placeholder {
      display: none;
    }
    .peek-placeholder {
      position: absolute;
      inset: 0;
      display: none;
      background: repeating-linear-gradient(
        45deg,
        rgba(0, 0, 0, 0.04) 0px,
        rgba(0, 0, 0, 0.04) 8px,
        rgba(255, 255, 255, 0.5) 8px,
        rgba(255, 255, 255, 0.5) 16px
      );
      pointer-events: none;
    }

    .hero-card-wrap:hover .peek-card,
    .hero-card-wrap.is-peeking .peek-card {
      opacity: 1;
      pointer-events: auto;
    }
    .hero-card-wrap.is-peeking .peek-card.peek-1,
    .hero-card-wrap:hover .peek-card.peek-1 {
      transform: translate(28px, -24px) rotate(2deg);
    }
    .hero-card-wrap.is-peeking .peek-card.peek-2,
    .hero-card-wrap:hover .peek-card.peek-2 {
      transform: translate(44px, -16px) rotate(-2deg);
    }
    .hero-card-wrap.is-peeking .peek-card.peek-3,
    .hero-card-wrap:hover .peek-card.peek-3 {
      transform: translate(60px, 14px) rotate(1deg);
    }

    .hero-card {
      position: relative;
      z-index: 3;
      width: 100%;
      background: transparent;
      border: 1px solid rgba(0, 0, 0, 0.08);
      border-radius: 0;
      box-shadow: 0 18px 60px rgba(0, 0, 0, 0.08);
      padding: 40px 0;
      overflow: hidden;
    }
    .hero-card::before,
    .hero-card::after {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      height: 40px;
      background: #fff;
      z-index: 0;
    }
    .hero-card::before { top: 0; }
    .hero-card::after { bottom: 0; }

    .hero-logo-wrap {
      position: relative;
      z-index: 1;
      width: 100%;
      height: min(320px, 42vh);
      overflow: hidden;
    }

    .hero-logo {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      object-position: center;
    }

    .hero .tagline {
      position: relative;
      z-index: 3;
      margin-top: -2rem;
      font-size: clamp(1.05rem, 2.2vw, 1.25rem);
      color: #000;
      font-weight: 700;
      max-width: 480px;
      transform: translateY(var(--hero-tagline-offset));
    }
    .hero .hero-links {
      position: relative;
      z-index: 3;
      margin-top: 1.5rem;
      justify-content: center;
      transform: translateY(var(--hero-tagline-offset));
    }

    section {
      width: 100%;
      margin: 0 auto;
      padding: clamp(3rem, 6vw, 5rem) clamp(1rem, 5vw, 2rem);
    }
    #projects, #ai, #article {
      padding-top: var(--tab-to-content);
    }

    section .section-inner {
      max-width: 1280px;
      margin: 0 auto;
    }

    section h2 {
      font-size: clamp(1.5rem, 4vw, 1.75rem);
      font-weight: 600;
      margin-bottom: 2rem;
      color: var(--text);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    body[data-tab="home"] #hero,
    body[data-tab="about"] #about {
      display: flex !important;
    }
    body[data-tab="projects"] #projects,
    body[data-tab="ai"] #ai,
    body[data-tab="article"] #article {
      display: block !important;
    }
    body[data-tab="home"] #projects,
    body[data-tab="home"] #ai,
    body[data-tab="home"] #article,
    body[data-tab="home"] #about,
    body[data-tab="projects"] #hero,
    body[data-tab="projects"] #ai,
    body[data-tab="projects"] #article,
    body[data-tab="projects"] #about,
    body[data-tab="ai"] #hero,
    body[data-tab="ai"] #projects,
    body[data-tab="ai"] #article,
    body[data-tab="ai"] #about,
    body[data-tab="article"] #hero,
    body[data-tab="article"] #projects,
    body[data-tab="article"] #ai,
    body[data-tab="article"] #about,
    body[data-tab="about"] #hero,
    body[data-tab="about"] #projects,
    body[data-tab="about"] #ai,
    body[data-tab="about"] #article {
      display: none !important;
    }

    #article {
      min-height: 100vh;
    }
    #article.article-showing-list {
      padding-top: var(--tab-to-content);
      padding-left: 0;
      padding-right: 0;
      padding-bottom: 0;
      background: #F2F2F7;
    }
    #article.article-showing-list .section-inner {
      max-width: none;
      padding: 0;
    }
    #ai.ai-showing-list {
      padding-top: var(--tab-to-content);
      padding-left: 0;
      padding-right: 0;
      padding-bottom: 0;
      background: #F2F2F7;
    }
    #ai.ai-showing-list .section-inner {
      max-width: none;
      padding: 0;
    }
    #ai .article-item-right {
      display: none;
    }
    #ai .article-item-left {
      width: 100%;
    }
    body.article-list-view,
    body.ai-list-view {
      overflow: hidden;
    }
    html.article-list-view,
    html.ai-list-view {
      overflow: hidden;
    }
    body.ai-list-view footer {
      display: none;
    }
    #ai-list-wrap.article-list-view {
      height: calc(100vh - var(--tab-to-content));
    }
    .article-item-inner {
      width: 100%;
      height: 100%;
      margin: 0 auto;
      padding: 1rem 1.5rem;
      box-sizing: border-box;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    @media (min-width: 1024px) {
      .article-item-inner {
        padding: 1.5rem 2rem;
      }
    }
    .article-item-card {
      display: flex;
      flex-direction: row;
      width: 100%;
      height: 100%;
      max-width: 1280px;
      margin: 0 auto;
      background: #fff;
      overflow: hidden;
      min-height: 0;
      box-sizing: border-box;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }
    #article .article-item-link:hover .article-item-card,
    #ai .article-item-link:hover .article-item-card {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
    }
    #article.article-view-detail {
      background: #F2F2F7;
    }
    #article.article-view-detail .section-inner > h2 {
      display: none;
    }
    #article.article-view-detail .article-detail-wrap.is-visible,
    #article.article-view-detail .article-editor-wrap.is-visible {
      padding-top: 80px;
    }

    .article-list-wrap.article-list-view {
      width: 100%;
      height: calc(100vh - var(--tab-to-content));
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    #ai-list-wrap.article-list-view {
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow: hidden;
    }
    #ai-list-wrap .article-list {
      margin: 0 auto;
      width: 100%;
      max-width: 720px;
      flex: 1;
      min-height: 0;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    #ai-list-wrap .article-list::-webkit-scrollbar {
      display: none;
    }
    .article-list-wrap.article-list-view::-webkit-scrollbar {
      display: none;
    }
    #ai-list-wrap .article-list-footer {
      flex-shrink: 0;
    }
    .article-list-footer {
      flex-shrink: 0;
      text-align: center;
      padding: clamp(1.5rem, 4vw, 2rem);
      color: var(--text-muted);
      font-size: 0.875rem;
      border-top: 1px solid var(--border);
      background: var(--bg-card);
      width: 100%;
    }
    .article-list-wrap.is-hidden .article-list-footer {
      display: none;
    }
    .article-list {
      list-style: none;
      display: block;
      padding: 0;
      margin: 0;
      /* åº•éƒ¨ç•™ç™½éœ€è¶³å¤Ÿå¤§ï¼Œæ»‘åˆ°åº•æ—¶æœ€åä¸€å¼ å¡ç‰‡èƒ½å®Œå…¨å åœ¨ä¸Šä¸€å¼ ä¹‹ä¸Š */
      padding-bottom: calc(100vh - var(--tab-to-content) - (100vh - var(--tab-to-content)) / 1.5);
    }
    .article-item {
      position: sticky;
      top: 0;
      height: calc((100vh - var(--tab-to-content)) / 1.5);
      display: flex;
      flex-direction: row;
      background: transparent;
      z-index: 1;
    }
    .article-item:nth-child(1) { z-index: 1; }
    .article-item:nth-child(2) { z-index: 2; }
    .article-item:nth-child(3) { z-index: 3; }
    .article-item:nth-child(4) { z-index: 4; }
    .article-item:nth-child(5) { z-index: 5; }
    .article-item:nth-child(6) { z-index: 6; }
    .article-item:nth-child(7) { z-index: 7; }
    .article-item:nth-child(8) { z-index: 8; }
    .article-item:nth-child(9) { z-index: 9; }
    .article-item:nth-child(10) { z-index: 10; }
    .article-item-link {
      display: block;
      width: 100%;
      max-width: 1280px;
      height: 100%;
      text-decoration: none;
      color: inherit;
    }
    .article-item-left {
      width: 100%;
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 2rem;
      box-sizing: border-box;
    }
    .article-item-tag {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 16px;
      margin-bottom: 0;
    }
    .article-item-tag-num {
      color: #000;
      font-weight: 600;
    }
    .article-item-tag-sep {
      color: #d1d5db;
      font-weight: 300;
    }
    .article-item-tag-cat {
      color: #6b7280;
    }
    #ai .article-item-tag-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      margin-bottom: 0;
    }
    #ai .article-item-ai-icon {
      width: 40px;
      height: 40px;
      object-fit: contain;
      flex-shrink: 0;
    }
    .article-item-content {
      margin-top: 3rem;
      margin-bottom: 0;
    }
    .article-item-title {
      font-size: 36px;
      font-weight: 700;
      line-height: 1.15;
      letter-spacing: -0.02em;
      color: #000;
      margin-bottom: 2rem;
    }
    #article .article-item-title {
      font-size: 30px;
    }
    .article-item-excerpt {
      font-size: 16px;
      line-height: 1.8;
      color: #374151;
      margin-bottom: 2.5rem;
      max-width: 100%;
    }
    .article-item-cta {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 1.25rem 2.5rem;
      background: #000;
      color: #fff;
      font-size: 18px;
      font-weight: 600;
      border-radius: 9999px;
      transition: background-color 0.2s, transform 0.1s;
    }
    .article-item-link:hover .article-item-cta {
      background-color: #1f2937;
    }
    .article-item-link:active .article-item-cta {
      transform: scale(0.98);
    }
    .article-item-right {
      flex: 1;
      min-width: 0;
      min-height: 220px;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .article-item-thumb {
      width: 100%;
      height: 100%;
      min-height: 220px;
      position: relative;
    }
    @media (min-width: 1024px) {
      .article-item-left {
        width: 680px;
        flex: none;
        padding: 80px;
      }
      .article-item-tag {
        font-size: 20px;
      }
      .article-item-content {
        margin-top: 0;
      }
      .article-item-title {
        font-size: 56px;
        margin-bottom: 2rem;
      }
      #article .article-item-title {
        font-size: 42px;
      }
      .article-item-excerpt {
        font-size: 18px;
      }
      .article-item-right {
        min-height: 100%;
      }
      .article-item-thumb {
        min-height: 100%;
      }
    }
    .article-item-thumb img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .article-body {
      display: none;
    }
    .article-title {
      display: none;
    }
    .article-subtitle {
      font-size: 0.9rem;
      font-weight: 400;
      margin-bottom: 0.35rem;
      color: rgba(0, 0, 0, 0.8);
      line-height: 1.3;
    }
    .article-date {
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    .article-list-wrap { display: block; }
    .article-detail-wrap { display: none; max-width: 1280px; margin: 0 auto; }
    .article-detail-wrap.is-visible { display: block; }
    .article-list-wrap.is-hidden { display: none; }
    .article-detail-back {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 2rem;
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.95rem;
    }
    .article-detail-back:hover { color: var(--accent-blue); }
    .article-detail-title {
      font-size: clamp(1.75rem, 4vw, 2.25rem);
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: #000;
      line-height: 1.2;
    }
    .article-detail-meta { font-size: 0.9rem; color: var(--text-muted); margin-bottom: 2rem; }
    #article.article-view-detail .article-detail-meta { display: none; }
    .article-detail-content {
      font-size: 1rem;
      line-height: 1.7;
      color: var(--text);
    }
    .article-detail-content h3 { margin: 1.5em 0 0.5em; font-size: 1.2em; }
    .article-detail-content p { margin-bottom: 1em; }
    .article-detail-content img {
      width: 100%;
      max-width: 100%;
      height: auto;
      display: block;
      border-radius: 0;
    }
    .article-detail-content .article-missing-img,
    .article-detail-content .article-missing-video {
      display: inline-block;
      padding: 0.5rem 0.75rem;
      margin: 0.25rem 0;
      background: rgba(0, 0, 0, 0.06);
      color: var(--text-muted);
      font-size: 0.9rem;
      border-radius: 4px;
    }
    .article-detail-content video {
      width: 100%;
      max-width: 100%;
      height: auto;
      display: block;
      border-radius: var(--radius);
      background: #000;
    }
    .article-detail-edit-link {
      display: inline-block;
      margin-top: 1rem;
      font-size: 0.9rem;
      color: var(--text-muted);
      text-decoration: none;
    }
    .article-detail-edit-link:hover { color: var(--accent-blue); }
    .article-editor-wrap {
      display: none;
      max-width: 1280px;
      margin: 0 auto;
    }
    .article-editor-wrap.is-visible { display: block; }
    .article-editor-wrap .article-editor-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text);
    }
    .article-editor-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
    }
    .article-editor-toolbar button {
      padding: 0.4rem 0.9rem;
      font-family: var(--font);
      font-size: 0.875rem;
      border-radius: var(--radius);
      cursor: pointer;
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text);
    }
    .article-editor-toolbar button:hover { border-color: var(--accent-blue); color: var(--accent-blue); }
    .article-editor-hint {
      font-size: 0.8rem;
      color: var(--text-muted);
      align-self: center;
      margin-left: 0.5rem;
    }
    .article-editor-textarea {
      width: 100%;
      min-height: 320px;
      padding: 1rem;
      font-family: var(--font);
      font-size: 1rem;
      line-height: 1.6;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      resize: vertical;
    }
    .article-editor-actions {
      margin-top: 1rem;
      display: flex;
      gap: 0.75rem;
    }
    .article-editor-actions button {
      padding: 0.6rem 1.25rem;
      font-family: var(--font);
      font-size: 0.95rem;
      border-radius: var(--radius);
      cursor: pointer;
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text);
    }
    .article-editor-actions button:hover { border-color: var(--accent-blue); color: var(--accent-blue); }
    .article-editor-actions button.primary { background: var(--accent-blue); color: #fff; border-color: var(--accent-blue); }
    .article-editor-actions button.primary:hover { opacity: 0.9; }
    @media (max-width: 1023px) {
      .article-item-card {
        flex-direction: column;
        min-height: auto;
        overflow: visible;
      }
      .article-item-right {
        display: none;
      }
      .article-item-thumb {
        display: none;
      }
      .article-item-left {
        width: 100%;
        min-width: 0;
      }
      #article .article-item-title,
      #article .article-item-excerpt {
        word-break: normal;
        overflow-wrap: break-word;
      }
      #article .article-item,
      #ai .article-item {
        height: auto;
        min-height: 0;
        position: relative;
      }
      #article .article-item-inner,
      #ai .article-item-inner {
        min-height: 0;
        overflow: visible;
      }
      #article .article-item-content {
        width: 100%;
        overflow: visible;
      }
      #article .article-item-cta {
        white-space: nowrap;
      }
      #article .article-list,
      #ai .article-list {
        padding-bottom: 1.5rem;
      }
      #article .article-item-tag,
      #ai .article-item-tag {
        font-size: 13px;
        gap: 0.5rem;
      }
      #article .article-item-title,
      #ai .article-item-title {
        font-size: 22px;
        margin-bottom: 1rem;
      }
      #article .article-item-excerpt,
      #ai .article-item-excerpt {
        font-size: 14px;
        margin-bottom: 1.25rem;
      }
      #article .article-item-cta,
      #ai .article-item-cta {
        font-size: 14px;
        padding: 0.75rem 1.5rem;
      }
      /* Design æ¨¡å—ç§»åŠ¨ç«¯ï¼šé…å›¾åœ¨ã€ŒæŸ¥çœ‹è¯¦æƒ…ã€æŒ‰é’®ä¸‹æ–¹ï¼Œå¡ç‰‡å†…éƒ¨æœ€åº•éƒ¨ */
      #article .article-item-mobile-img {
        display: block;
        margin-top: 1.25rem;
        width: 100%;
        line-height: 0;
        flex-shrink: 0;
      }
      #article .article-item-mobile-img img {
        width: 100%;
        height: auto;
        display: block;
        object-fit: cover;
        border-radius: 12px;
      }
      #ai .article-item-mobile-img {
        display: none;
      }
    }
    .article-item-mobile-img {
      display: none;
    }
    @media (max-width: 768px) {
      .article-item-link {
        flex-direction: column;
      }
      .article-item-inner {
        padding: 1rem;
      }
      #article.article-view-detail .article-detail-wrap.is-visible,
      #article.article-view-detail .article-editor-wrap.is-visible {
        padding-top: 0;
      }
      #article.article-view-detail .article-detail-back {
        margin-bottom: 1rem;
      }
      #article.article-view-detail .article-detail-meta {
        margin-bottom: 1rem;
      }
      /* æ–‡ç« è¯¦æƒ…ç§»åŠ¨ç«¯ï¼šä¸ PC ä¸€è‡´çš„é˜…è¯»åŒºåŸŸï¼Œé¿å…å¼‚å¸¸å—çŠ¶/è“è‰²èƒŒæ™¯ */
      #article.article-view-detail .article-detail-wrap {
        padding-left: 1rem;
        padding-right: 1rem;
        padding-bottom: 2rem;
        box-sizing: border-box;
      }
      #article.article-view-detail .article-detail-content {
        max-width: 100%;
        overflow-x: hidden;
      }
      #article.article-view-detail .article-detail-content img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 1em 0;
        background: transparent;
        border-radius: 4px;
      }
      #article.article-view-detail .article-detail-content p {
        max-width: 100%;
      }
      #article.article-view-detail .article-detail-content div,
      #article.article-view-detail .article-detail-content figure {
        max-width: 100%;
        background: transparent !important;
      }
      #article.article-view-detail .article-detail-content img {
        min-height: 0;
        object-fit: contain;
      }
    }

    #about {
      background: linear-gradient(180deg, #F67F00 0%, #FFFFFF 95%);
      background-attachment: scroll;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      font-size: 1.25rem;
      padding-top: var(--tab-to-content);
      box-sizing: border-box;
    }

    #about .section-inner {
      text-align: center;
      width: 100%;
    }
    #about .about-avatar {
      display: block;
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 1.5rem;
      border: 3px solid rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }

    #about h2 {
      color: #000;
    }

    .about-content {
      margin-bottom: 2rem;
    }

    #about .about-content p {
      color: #000;
      margin-bottom: 1rem;
      font-size: 1.05em;
      line-height: 1.75;
      font-weight: 600;
    }

    /* About ä¸»æ ‡é¢˜ï¼šç¬¬ä¸€æ®µä½œä¸ºæ ‡é¢˜ï¼Œå­—å·æ›´å¤§ */
    #about .about-content p:first-of-type {
      font-size: clamp(1.4rem, 4vw, 1.85rem);
      font-weight: 600;
      color: #000;
      line-height: 1.35;
      margin-bottom: 1.5rem;
      letter-spacing: 0.02em;
    }

    /* About æ­£æ–‡ï¼šå…¶ä½™æ®µè½ç•¥å°ï¼Œå½¢æˆå±‚æ¬¡ */
    #about .about-content p:not(:first-of-type) {
      font-size: 1em;
      max-width: 42em;
      margin-left: auto;
      margin-right: auto;
      font-weight: 600;
    }

    .about-links {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1.5rem;
      justify-content: center;
    }

    .about-link-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.65rem 1.25rem;
      border-radius: 999px;
      border: 1px solid rgba(0, 0, 0, 0.2);
      background: rgba(255, 255, 255, 0.9);
      color: #000;
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      transition: border-color 0.2s, color 0.2s, box-shadow 0.2s;
    }

    .about-link-btn:hover {
      border-color: rgba(0, 0, 0, 0.4);
      color: #000;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
    }

    .about-link-btn span:first-child {
      font-size: 1.1em;
    }

    .about-hover-preview {
      position: fixed;
      z-index: 1001;
      pointer-events: none;
      display: none;
      border-radius: 0;
      overflow: hidden;
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
      border: 1px solid var(--border);
      background: #fff;
    }
    .about-hover-preview.is-visible {
      display: block;
    }
    .about-hover-preview img {
      display: block;
      max-width: 200px;
      max-height: 200px;
      width: auto;
      height: auto;
      object-fit: contain;
    }

    #projects {
      background: #F2F2F7;
    }
    #projects h2,
    #ai h2,
    #article h2 {
      text-align: left;
      margin-top: 60px;
      margin-bottom: 24px;
      font-size: 36px;
    }

    #projects .section-inner {
      max-width: 1280px;
      padding-left: 0;
      padding-right: 0;
    }

    .works-gallery {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: clamp(0.5rem, 2vw, 1rem);
      width: 100%;
      max-width: 1280px;
      margin: 0 auto;
      padding: 0;
    }

    .work-item {
      margin: 0;
      aspect-ratio: 1;
      border-radius: 0;
      overflow: hidden;
      background: #f1f5f9;
      cursor: pointer;
      line-height: 0;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .work-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
    }

    .work-item img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
    }

    .lightbox {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 1000;
      background: rgba(0, 0, 0, 0.9);
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .lightbox.is-open {
      display: flex;
    }

    .lightbox img {
      max-width: 100%;
      max-height: 90vh;
      width: auto;
      height: auto;
      object-fit: contain;
    }

    .lightbox-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 2.5rem;
      height: 2.5rem;
      border: none;
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
      font-size: 1.5rem;
      line-height: 1;
      cursor: pointer;
      border-radius: 50%;
    }

    .lightbox-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    @media (max-width: 640px) {
      .works-gallery { grid-template-columns: repeat(2, 1fr); gap: 0.5rem; }
    }

    footer {
      text-align: center;
      padding: clamp(1.5rem, 4vw, 2rem);
      color: var(--text-muted);
      font-size: 0.875rem;
      border-top: 1px solid var(--border);
      background: var(--bg-card);
      width: 100%;
    }

    @media (min-width: 768px) {
      :root {
        --tab-to-content: 5rem;
      }
    }
    @media (max-width: 640px) {
      :root {
        --tab-to-content: 6rem;
      }
      /* é¡¶éƒ¨ç•™å‡ºå›ºå®šå¯¼èˆªé«˜åº¦ï¼Œå†…å®¹ä»ä¸‹æ–¹å¼€å§‹æ’å¸ƒï¼Œé¿å…æ’ç”»é¡¶è¿› Tab åŒºåŸŸ */
      .hero {
        padding-top: 5.5rem;
        padding-bottom: clamp(2rem, 8vw, 4rem);
        --hero-tagline-offset: 0;
        justify-content: flex-start;
        min-height: 100vh;
        min-height: 100dvh;
      }
      .hero .tagline {
        margin-top: 1.25rem;
      }
      .hero .hero-links {
        margin-top: 1.25rem;
      }
      .hero-name { display: none; }
      /* ä¸å†ä¸Šç§»ï¼Œé¿å…ä¸ Tab é‡å  */
      .hero-illustration { transform: scale(0.75); }
      /* ç§»åŠ¨ç«¯å›ºå®šæ’ç”»å®¹å™¨å®½é«˜æ¯”ï¼Œä½¿ bg-card ä¸ home-me åœ¨åŒä¸€æ¯”ä¾‹ä¸‹ç¼©æ”¾ï¼Œè§†è§‰ä¸€è‡´ */
      .parallax-container {
        aspect-ratio: 3/4;
        height: auto;
        max-height: min(70vh, 560px);
      }
      /* ç§»åŠ¨ç«¯éšè—å³åˆ»æŒ‰é’® */
      .hero-links .hero-link-jike {
        display: none;
      }
      nav { padding: 0.5rem 0.75rem; }
      nav .nav-inner { padding: 0.5rem 1rem; }
      nav ul { gap: clamp(0.5rem, 2vw, 1rem); flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
      nav ul::-webkit-scrollbar { display: none; }
      nav a { padding: 0.4rem 0.5rem; min-height: 36px; min-width: 36px; line-height: 1.2; margin: 0; display: inline-flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 0.9rem; }
      /* About ç§»åŠ¨ç«¯ï¼šç¼©å°æ–‡å­—ã€ä¸é¡¶éƒ¨ tab ç•™è¶³é—´è· */
      #about {
        font-size: 1rem;
        padding-top: var(--tab-to-content);
        padding-left: 1rem;
        padding-right: 1rem;
      }
      #about .about-content p:first-of-type {
        font-size: clamp(1.05rem, 4.5vw, 1.25rem);
        line-height: 1.4;
        margin-bottom: 1.25rem;
      }
      #about .about-content p:not(:first-of-type) {
        font-size: 0.9375rem;
        line-height: 1.65;
      }
      #about .about-avatar {
        width: 96px;
        height: 96px;
        margin-bottom: 1.25rem;
      }
    }

    /* æœ€å°å±ï¼ˆå¦‚ 375px åŠä»¥ä¸‹ï¼‰ï¼šä¸ 640px ä»¥ä¸‹ä¸€è‡´ï¼Œä¸é‡å  */
    @media (max-width: 400px) {
      .hero {
        --hero-tagline-offset: 0;
      }
    }

    /* ç§»åŠ¨ç«¯å·¦å³æ»‘åŠ¨ Tabï¼šä»… < 768px ç”Ÿæ•ˆ */
    @media (max-width: 767px) {
      .page-wrap {
        display: flex;
        flex-direction: column;
        min-height: 0;
        flex: 1;
      }
      .swipe-wrapper {
        display: flex;
        overflow-x: auto;
        overflow-y: hidden;
        scroll-snap-type: x mandatory;
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch;
        overscroll-behavior-x: contain;
        flex: 1;
        min-height: 0;
        width: 100%;
        height: 100vh;
        height: 100dvh;
      }
      .swipe-wrapper .swipe-page {
        flex: 0 0 100%;
        width: 100%;
        min-width: 100%;
        height: 100%;
        min-height: 100%;
        scroll-snap-align: start;
        scroll-snap-stop: always;
        overflow-y: auto;
        overflow-x: hidden;
        box-sizing: border-box;
        align-self: stretch;
      }
      /* æ»‘åŠ¨æ¨¡å¼ä¸‹ä¸æŒ‰ data-tab æ˜¾éšï¼Œäº”å—å§‹ç»ˆå‚ä¸æ¨ªå‘æ’å¸ƒï¼›ä»…ä¸­é—´ä¸‰å—ç”¨ blockï¼Œhero/about ä¿æŒ flex é¿å…å†…å®¹ä¸æ˜¾ç¤º */
      body.swipe-mode #projects,
      body.swipe-mode #article,
      body.swipe-mode #ai {
        display: block !important;
      }
      body.swipe-mode #hero,
      body.swipe-mode #about {
        display: flex !important;
      }
      /* ç§»åŠ¨ç«¯ Design/Tool åˆ—è¡¨é¡µä¸ swipe åŒé£æ ¼ï¼Œé¿å…åˆ‡æ¢æ—¶åº•è‰²å’Œå®½åº¦è·³é—ª */
      /* ç¼©å° tab ä¸‹æ–¹ç•™ç™½(4rem)ï¼Œé¿å… tab ä¸å†…å®¹é—´å¤§é¢ç§¯ç©ºç™½é®æŒ¡åˆ—è¡¨ */
      body.swipe-mode #ai,
      body.swipe-mode #article {
        --tab-to-content: 4rem;
        background: #F2F2F7;
        padding-top: 4rem;
        padding-left: 0;
        padding-right: 0;
        padding-bottom: 0;
      }
      body.swipe-mode #ai .section-inner,
      body.swipe-mode #article .section-inner {
        max-width: none;
        padding: 0;
      }
      /* Tab æ å¯æ¨ªå‘æ»šåŠ¨ï¼Œç‚¹å‡»æ—¶é€‰ä¸­é¡¹æ»šåŠ¨åˆ°è§†å£ä¸­å¿ƒ */
      #main-nav { padding: 0.4rem 0.6rem; }
      #main-nav .nav-inner {
        padding: 0.45rem 0.85rem;
        overflow-x: auto;
        overflow-y: hidden;
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch;
      }
      /* ç§»åŠ¨ç«¯ swipe æ¨¡å¼ï¼šArt/Design/Tool ä¸‰å— Tab è§†è§‰å®Œå…¨ç»Ÿä¸€ï¼ŒåŠé€æ˜ç™½åº• + è“è‰²é«˜äº® */
      body.swipe-mode[data-tab="projects"] #main-nav .nav-inner,
      body.swipe-mode[data-tab="article"] #main-nav .nav-inner,
      body.swipe-mode[data-tab="ai"] #main-nav .nav-inner {
        background: rgba(255, 255, 255, 0.8);
        min-height: 0;
      }
      /* ç§»åŠ¨ç«¯ swipeï¼šç¦ç”¨ article/ai åˆ—è¡¨é¡¹çš„ stickyï¼Œé¿å…ç™½å¡ç‰‡å¸é¡¶æ—¶é®æŒ¡ä¸‹æ–¹å†…å®¹ */
      body.swipe-mode #article .article-item,
      body.swipe-mode #ai .article-item {
        position: relative !important;
        top: auto !important;
      }
      #main-nav ul { flex-wrap: nowrap; gap: 0.35rem 0.75rem; }
      #main-nav a { padding: 0.35rem 0.45rem; min-height: 34px; min-width: 34px; line-height: 1.2; font-size: 0.875rem; }
      /* éšè— footerï¼Œè®© swipe åŒºåŸŸå æ»¡è§†å£ï¼Œé¦–é¡µæ¸å˜å…¨å± */
      body.swipe-mode footer {
        display: none;
      }
      /* Hero ç§»åŠ¨ç«¯å‚ç›´å †å ï¼šå›¾ç‰‡ â†’ AFU ZHANG â†’ æè¿° â†’ æŒ‰é’® */
      .hero-center {
        flex-direction: column;
        align-items: center;
      }
      .hero-name-block {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        max-width: 100%;
      }
      .hero-name-block .hero-name {
        display: none;
      }
      .hero-name-block .hero-card-wrap {
        order: 0;
      }
      .hero-name-mobile {
        display: block;
        order: 1;
        margin-top: 1rem;
        margin-bottom: 0.5rem;
        font-size: clamp(2rem, 9vw, 3rem);
        font-weight: 700;
        color: #000;
        letter-spacing: 0.02em;
        line-height: 1;
        white-space: nowrap;
      }
    }

    .tab-transition-overlay {
      position: fixed;
      inset: 0;
      z-index: 9998;
      background: #f5f5f7;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.22s ease-out;
    }
    .tab-transition-overlay.is-active {
      opacity: 1;
      pointer-events: auto;
    }
    @media (max-width: 767px) {
      .tab-transition-overlay {
        display: none !important;
      }
    }
  </style>
</head>
<body data-tab="home">
  <div class="tab-transition-overlay" id="tab-transition-overlay" aria-hidden="true"></div>
  <nav id="main-nav">
    <div class="nav-inner">
      <ul>
        <li><a href="#hero">Home</a></li>
        <li><a href="#projects">Art</a></li>
        <li><a href="#article">Design</a></li>
        <li><a href="#ai">Tool</a></li>
        <li><a href="#about">About</a></li>
      </ul>
    </div>
  </nav>

  <div class="page-wrap">
  <section id="hero" class="hero">
    <div class="hero-bg" aria-hidden="true">
      <div class="hero-bg-layer hero-bg-1"></div>
      <div class="hero-bg-layer hero-bg-2"></div>
      <div class="hero-bg-layer hero-bg-3"></div>
      <div class="hero-bg-layer hero-bg-4"></div>
    </div>
    <div class="hero-center">
      <div class="hero-name-block">
        <span class="hero-name hero-name-left">AFU</span>
        <div class="hero-card-wrap" id="hero-card-wrap">
          <div class="parallax-container hero-illustration" id="hero-parallax">
            <img class="layer-bg" src="bg-card.png" alt="">
            <img class="layer-character" src="home-me_1.png" alt="Afu">
          </div>
        </div>
        <span class="hero-name hero-name-right">ZHANG</span>
        <span class="hero-name-mobile">AFU ZHANG</span>
      </div>
    </div>
    <p class="tagline">Designer, AI learner, daily observer. No-code independent developer. Focused on AI, LLM, and design.</p>
    <div class="about-links hero-links">
      <a href="https://xhslink.com/m/1xzlmbP3IhU" target="_blank" rel="noopener" class="about-link-btn" data-hover-img="xiaohongshu.png"><span>ğŸ‘‹</span><span>å°çº¢ä¹¦</span></a>
      <span class="about-link-btn" style="cursor: default;" data-hover-img="wechat.png"><span>ğŸ‘‹</span><span>WeChat</span></span>
      <a href="https://web.okjike.com" target="_blank" rel="noopener" class="about-link-btn hero-link-jike" data-hover-img="jike.png"><span>ğŸ‘‹</span><span>å³åˆ»</span></a>
    </div>
    <div class="about-hover-preview" id="about-hover-preview" aria-hidden="true"><img src="" alt=""></div>
  </section>

  <section id="projects">
    <div class="works-gallery" id="works-gallery"></div>
  </section>

  <section id="ai">
    <div class="section-inner">
      <div class="article-list-wrap article-list-view" id="ai-list-wrap">
        <ul class="article-list" id="ai-list"></ul>
        <div class="article-list-footer">
          <p>Â© 2025 Afu Â· Portfolio</p>
        </div>
      </div>
    </div>
  </section>

  <section id="article">
    <div class="section-inner">
      <div class="article-list-wrap" id="article-list-wrap">
        <ul class="article-list" id="article-list"></ul>
        <div class="article-list-footer">
          <p>Â© 2025 Afu Â· Portfolio</p>
        </div>
      </div>
      <div class="article-detail-wrap" id="article-detail-wrap" aria-hidden="true">
        <a href="#article" class="article-detail-back" id="article-detail-back">â† è¿”å›åˆ—è¡¨</a>
        <h1 class="article-detail-title" id="article-detail-title"></h1>
        <p class="article-detail-meta" id="article-detail-meta"></p>
        <div class="article-detail-content" id="article-detail-content"></div>
        <a href="#" class="article-detail-edit-link" id="article-detail-edit-link">ç¼–è¾‘æ­£æ–‡</a>
      </div>
      <div class="article-editor-wrap" id="article-editor-wrap" aria-hidden="true">
        <a href="#article" class="article-detail-back" id="article-editor-back">â† è¿”å›åˆ—è¡¨</a>
        <h2 class="article-detail-title" id="article-editor-title" style="margin-bottom:1rem;"></h2>
        <label class="article-editor-label" for="article-editor-textarea">æ­£æ–‡</label>
        <div class="article-editor-toolbar">
          <button type="button" id="article-editor-insert-p">æ’å…¥æ®µè½</button>
          <input type="file" id="article-editor-upload-img" accept="image/*" multiple style="display:none;">
          <button type="button" id="article-editor-insert-img">æ’å…¥å›¾ç‰‡ï¼ˆå¯æ‰¹é‡æœ¬åœ°ä¸Šä¼ ï¼‰</button>
          <input type="file" id="article-editor-upload-video" accept="video/*" style="display:none;">
          <button type="button" id="article-editor-insert-video">æ’å…¥è§†é¢‘</button>
          <button type="button" id="article-editor-insert-h3">æ’å…¥å°æ ‡é¢˜</button>
          <span class="article-editor-hint">å•ç¯‡çº¦ 5MB é™åˆ¶ï¼Œå›¾ç‰‡/è§†é¢‘è¿‡å¤šè¯·åˆ†æ‰¹æˆ–å‹ç¼©åä¸Šä¼ </span>
        </div>
        <textarea class="article-editor-textarea" id="article-editor-textarea" placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´æ­£æ–‡ã€‚å¯ç”¨ä¸Šæ–¹æŒ‰é’®æ’å…¥æ®µè½ã€å›¾ç‰‡ã€å°æ ‡é¢˜ã€‚"></textarea>
        <div class="article-editor-actions">
          <button type="button" class="primary" id="article-editor-save">ä¿å­˜</button>
          <a href="#" id="article-editor-cancel" style="padding:0.6rem 1.25rem;font-size:0.95rem;color:var(--text-muted);">å–æ¶ˆ</a>
        </div>
      </div>
    </div>
  </section>

  <div id="lightbox" class="lightbox" aria-hidden="true">
    <button type="button" class="lightbox-close" aria-label="Close">Ã—</button>
    <img src="" alt="">
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      (function initParallax() {
        var container = document.getElementById('hero-parallax');
        if (!container) return;
        var layerBg = container.querySelector('.layer-bg');
        var layerChar = container.querySelector('.layer-character');
        if (!layerBg || !layerChar) return;
        var HERO_CHAR_IMAGES = ['home-me_1.png', 'home-me_2.png', 'home-me_3.png', 'home-me_4.png', 'home-me_5.png', 'home-me_6.png'];
        if (HERO_CHAR_IMAGES.length) {
          layerChar.src = HERO_CHAR_IMAGES[Math.floor(Math.random() * HERO_CHAR_IMAGES.length)];
        }
        var moveFactorBg = 0.008;
        var moveFactorChar = 0.015;
        document.addEventListener('mousemove', function (e) {
          var centerX = window.innerWidth / 2;
          var centerY = window.innerHeight / 2;
          var offsetX = (e.clientX - centerX) * moveFactorBg;
          var offsetY = (e.clientY - centerY) * moveFactorBg;
          layerBg.style.transform = 'translate(' + offsetX + 'px, ' + offsetY + 'px)';
          offsetX = (e.clientX - centerX) * moveFactorChar;
          offsetY = (e.clientY - centerY) * moveFactorChar;
          layerChar.style.transform = 'translate(' + offsetX + 'px, ' + offsetY + 'px)';
        });
      })();

      var WORK_IMAGES = [
        'work1.jpg', 'work2.jpg', 'work3.jpg', 'work4.jpg', 'work5.jpg', 'work6.jpg', 'work7.jpg', 'work8.jpg', 'work9.jpg', 'work10.jpg',
        'work11.jpg', 'work12.jpg', 'work13.jpg', 'work14.jpg', 'work15.jpg', 'work16.jpg', 'work17.jpg', 'work18.jpg',
        'work19.jpg', 'work20.jpg', 'work21.jpg', 'work22.jpg', 'work23.jpg', 'work24.jpg',
        'work25.jpg', 'work26.jpg', 'work28.jpg', 'work30.jpg', 'work31.jpg'
      ];

      /* æ–‡ç« åˆ—è¡¨ï¼šåœ¨æ­¤æ·»åŠ /ä¿®æ”¹æ–‡ç« ï¼Œæ¯é¡¹å« idã€thumbã€titleã€excerptã€dateã€contentï¼›content ä¸ºæ­£æ–‡ HTML */
      var ARTICLE_LIST = [
        {
          id: '1',
          thumb: 'article/article_1.png',
          title: 'TECHOPARKæ¦‚å¿µçš„å®šä¹‰ä¸ç†è§£',
          category: 'å“ç‰Œ / ç­–ç•¥',
          excerpt: 'è…¾è®¯ Techo å¼€å‘è€…å¤§ä¼šæ˜¯è…¾è®¯äº‘å‘èµ·çš„å…¨çƒæŠ€æœ¯ç››ä¼šï¼Œèšç„¦å‰æ²¿ç§‘æŠ€ä¸å¼€å‘è€…æˆé•¿ã€‚æœ¬æ¬¡é¡¹ç›®ä»¥â€œ0â€ä¸ºæ ¸å¿ƒç¬¦å·ï¼Œèåˆå¤šå…ƒæ¼”è®²è€…å½¢è±¡ä¸NFTæ¦‚å¿µï¼Œæ‰“é€ åˆ›æ–°è§†è§‰è¡¨è¾¾ã€‚',
          date: '2025-01-01',
          content: '<p>åœ¨è¿™é‡Œå¡«å†™æ­£æ–‡ï¼Œæˆ–ç‚¹å‡»æ–‡ç« é¡µçš„ã€Œç¼–è¾‘æ­£æ–‡ã€åœ¨ç¼–è¾‘å™¨ä¸­å¡«å†™ã€‚</p><p>æ”¯æŒ <strong>åŠ ç²—</strong>ã€<em>æ–œä½“</em>ã€<h3>å°æ ‡é¢˜</h3>ï¼Œä»¥åŠå›¾ç‰‡ï¼š<img src="article/article_1.png" alt=""></p>'
        },
        {
          id: '2',
          thumb: 'article/article_2.png',
          title: 'è…¾è®¯äº‘å®˜ç½‘å›¾å½¢é‡å¡‘',
          category: 'æ¦‚å¿µ / è§†è§‰ / åŠ¨æ•ˆ',
          excerpt: 'è…¾è®¯äº‘çš„å®˜ç½‘æ˜¯ç”¨æˆ·æ¥è§¦è…¾è®¯äº‘äº§å“é‡è¦çš„æ¸ é“ä¹‹ä¸€,å®˜ç½‘æ˜¯è…¾è®¯äº‘è®¾è®¡å†…å®¹å½“ä¸­å›¾å½¢è§†è§‰å’Œ å›¾å½¢è¡¨è¾¾è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¹‹ä¸€ã€‚ è´Ÿè´£æ•´ä¸ªå®˜ç½‘æ¨¡å‹çš„å›¾å½¢å·¥ä½œ:3Dé£æ ¼å®šè°ƒ,3Dæ¨¡å‹,ç½‘é¡µå›¾ç‰‡é£æ ¼å®šè°ƒ,é…å›¾ã€‚ é¡¹ç›®ä¸Šçº¿ä¹‹åå¾—åˆ°äº†æœ‰æ¥è‡ªäºè®¾è®¡è¡Œä¸šå’Œæ™®é€šç”¨æˆ·å¾ˆå¤šè®¤å¯ã€‚',
          date: '2025-01-02',
          content: '<p>ç¬¬äºŒç¯‡æ–‡ç« çš„æ­£æ–‡å†…å®¹ã€‚</p><p>åœ¨ ARTICLE_LIST é‡Œä¸ºæ¯ç¯‡æ–‡ç« åŠ ä¸€é¡¹ï¼Œå¡« titleã€excerptã€dateã€content å³å¯ã€‚</p>'
        },
        {
          id: '3',
          thumb: 'article/article_3.png',
          title: 'è…¾è®¯äº‘è®¾è®¡å“ç‰Œå‡çº§',
          category: 'æ¦‚å¿µ / è§†è§‰',
          excerpt: 'å“ç‰Œç„•æ–°ï¼Œæ˜¯ä¸€æ¬¡é‡æ–°å®šä¹‰è‡ªæˆ‘çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡æ›´ç³»ç»ŸåŒ–çš„è¡¨è¾¾ï¼Œå‘ˆç°è…¾è®¯äº‘è®¾è®¡å›¢é˜Ÿåœ¨æŠ€æœ¯è¯­å¢ƒä¸‹çš„åˆ›é€ èƒ½åŠ›ä¸ä¸“ä¸šæ€åº¦ï¼Œè®©è®¾è®¡æˆä¸ºæ¨åŠ¨åˆ›æ–°ä¸è¿æ¥ä¸–ç•Œçš„é‡è¦åŠ›é‡ã€‚',
          date: '2025-01-03',
          content: '<p>ç¬¬ä¸‰ç¯‡æ­£æ–‡ã€‚</p>'
        },
        {
          id: '4',
          thumb: 'article/article_4.jpg',
          title: 'è…¾è®¯ä¼šè®®IPå½¢è±¡è®¾è®¡',
          category: 'è§†è§‰',
          excerpt: 'å®ƒä¸æ˜¯æ™®é€šçš„ä¼é¹…ï¼Œä¹Ÿä¸æ˜¯ä¸¥è‚ƒçš„ä¼šè®®å·¥å…·ï¼Œå®ƒæ˜¯è…¾è®¯ä¼šè®®çš„çµé­‚ä»£è¨€äºº',
          date: '2025-01-15',
          content: '<p>è…¾è®¯ä¼šè®® IP å½¢è±¡è®¾è®¡ï¼Œå›´ç»•å“ç‰Œè°ƒæ€§æ‰“é€ ç»Ÿä¸€ã€æ˜“è¯†åˆ«çš„è§†è§‰å½¢è±¡ã€‚</p><p><img src="article/article_4.jpg" alt="è…¾è®¯ä¼šè®®IPå½¢è±¡è®¾è®¡"></p><p>æœ¬æ–‡è®°å½•ä»ç­–ç•¥åˆ°è½åœ°çš„å®Œæ•´æµç¨‹ä¸è®¾è®¡å†³ç­–ã€‚</p>'
        },
        {
          id: '5',
          thumb: 'article/article_5.jpg',
          title: 'å·¥ä½œæ‰‹è®°',
          category: 'è§†è§‰ / UX',
          excerpt: 'æ—¥å¸¸å·¥ä½œå†…å®¹çš„è®°å½•ï¼Œå¤§ä¼šçš„å®˜ç½‘ï¼ŒèŠ‚æ—¥æ´»åŠ¨',
          date: '2025-01-20',
          content: '<p>å›´ç»•æ ¸å¿ƒåŠŸèƒ½è®¾è®¡ä¸»è§†è§‰ä¸åŠ¨æ•ˆèŠ‚å¥ï¼Œå…¼é¡¾å“ç‰Œè°ƒæ€§ä¸å¯ç”¨æ€§ã€‚</p><p>å¯åœ¨æ­¤è¡¥å……é¡¹ç›®èƒŒæ™¯ã€è®¾è®¡æ€è·¯ä¸è½åœ°æ•ˆæœã€‚</p>'
        }
      ];

      /* AI å¡ç‰‡åˆ—è¡¨ï¼šæ¯é¡¹å« idã€thumbã€titleã€excerptï¼›å¯åŠ  link ä¸ºé“¾æ¥åœ°å€ï¼Œæ— åˆ™ç”¨ # */
      var AI_LIST = [
        {
          id: '1',
          title: 'LexiNoteå•è¯æœ¬',
          excerpt: 'æ˜¯ä¸€æ¬¾ Chrome å•è¯æœ¬æ’ä»¶ï¼Œè‡ªåŠ¨è®°å½• Google ç¿»è¯‘ä¸è±†åŒ…æŸ¥è¯ï¼ŒæŒ‰æ—¥æœŸç®¡ç†ï¼Œæä¾› B1 é‡Šä¹‰ä¸ B2 ä¾‹å¥ï¼Œä¸‰æ¬¡å‹¾é€‰æ ‡è®°æŒæ¡ï¼ŒåŠ©åŠ›é«˜æ•ˆè¯æ±‡å­¦ä¹ ã€‚',
          link: 'https://github.com/afu-botstar/LexiNote'
        }
      ];

      var galleryEl = document.getElementById('works-gallery');
      if (galleryEl) {
        galleryEl.innerHTML = WORK_IMAGES.map(function (src, i) {
          var alt = 'Work ' + (i + 1);
          return '<figure class="work-item" role="button" tabindex="0"><img src="' + src.replace(/"/g, '&quot;') + '" alt="' + alt.replace(/"/g, '&quot;') + '" loading="lazy"></figure>';
        }).join('');
      }

      var lightbox = document.getElementById('lightbox');
      var lbImg = lightbox.querySelector('img');
      var lbClose = lightbox.querySelector('.lightbox-close');

      function openLightbox(src, alt) {
        lbImg.src = src;
        lbImg.alt = alt || '';
        lightbox.classList.add('is-open');
        lightbox.setAttribute('aria-hidden', 'false');
      }

      document.querySelectorAll('.work-item').forEach(function (item) {
        item.addEventListener('click', function () {
          var img = this.querySelector('img');
          openLightbox(img.src, img.alt);
        });
        item.addEventListener('keydown', function (e) {
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); this.click(); }
        });
      });
      function closeLightbox() {
        lightbox.classList.remove('is-open');
        lightbox.setAttribute('aria-hidden', 'true');
      }
      lbClose.addEventListener('click', closeLightbox);
      lightbox.addEventListener('click', function (e) {
        if (e.target === lightbox) closeLightbox();
      });
      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' && lightbox.classList.contains('is-open')) closeLightbox();
      });

      var hoverPreview = document.getElementById('about-hover-preview');
      var hoverPreviewImg = hoverPreview ? hoverPreview.querySelector('img') : null;
      if (hoverPreview && hoverPreviewImg) {
        document.querySelectorAll('.about-link-btn[data-hover-img]').forEach(function (btn) {
          var src = btn.getAttribute('data-hover-img');
          if (!src) return;
          btn.addEventListener('mouseenter', function () {
            hoverPreviewImg.src = src;
            hoverPreview.setAttribute('aria-hidden', 'false');
            hoverPreview.classList.add('is-visible');
            var rect = btn.getBoundingClientRect();
            var x = rect.left + rect.width / 2 - 100;
            var y = Math.max(10, rect.top - 220);
            hoverPreview.style.left = Math.max(10, Math.min(x, document.documentElement.clientWidth - 210)) + 'px';
            hoverPreview.style.top = y + 'px';
          });
          btn.addEventListener('mouseleave', function () {
            hoverPreview.classList.remove('is-visible');
            hoverPreview.setAttribute('aria-hidden', 'true');
          });
        });
      }

      var nav = document.getElementById('main-nav');
      function onScroll() {
        if (nav) nav.classList.toggle('nav-scrolled', window.scrollY > 20);
        /* ç§»åŠ¨ç«¯ swipe æ¨¡å¼ä¸‹ï¼ŒArt/Design/Tool ä¸é€šè¿‡ scroll æ›´æ–° nav-bgï¼Œé¿å…ä¸ setNavActive å†²çªå¯¼è‡´ tab è¡¨ç°ä¸ä¸€è‡´ */
        if (document.body.classList.contains('swipe-mode')) {
          var tab = document.body.getAttribute('data-tab') || '';
          if (tab === 'projects' || tab === 'article' || tab === 'ai') return;
        }
        updateNavBgByScroll();
      }
      window.addEventListener('scroll', onScroll);

      var sections = {
        hero: document.getElementById('hero'),
        projects: document.getElementById('projects'),
        ai: document.getElementById('ai'),
        article: document.getElementById('article'),
        about: document.getElementById('about')
      };

      var articleListEl = document.getElementById('article-list');
      var articleListWrap = document.getElementById('article-list-wrap');
      var aiListEl = document.getElementById('ai-list');
      var aiListWrap = document.getElementById('ai-list-wrap');
      var articleDetailWrap = document.getElementById('article-detail-wrap');
      var articleDetailTitle = document.getElementById('article-detail-title');
      var articleDetailMeta = document.getElementById('article-detail-meta');
      var articleDetailContent = document.getElementById('article-detail-content');
      var articleDetailBack = document.getElementById('article-detail-back');
      var articleDetailEditLink = document.getElementById('article-detail-edit-link');
      var articleEditorWrap = document.getElementById('article-editor-wrap');
      var articleEditorTitle = document.getElementById('article-editor-title');
      var articleEditorTextarea = document.getElementById('article-editor-textarea');
      var articleEditorSave = document.getElementById('article-editor-save');
      var articleEditorBack = document.getElementById('article-editor-back');
      var articleEditorCancel = document.getElementById('article-editor-cancel');

      function insertAtCursor(ta, before, after) {
        if (!ta) return;
        var start = ta.selectionStart;
        var end = ta.selectionEnd;
        var val = ta.value;
        var sel = val.slice(start, end);
        var newVal = val.slice(0, start) + (before + sel + (after || '')) + val.slice(end);
        ta.value = newVal;
        ta.focus();
        ta.selectionStart = ta.selectionEnd = start + before.length + sel.length;
      }

      function onEditorInsertP() {
        insertAtCursor(articleEditorTextarea, '<p>', '</p>');
      }
      function onEditorInsertImg() {
        var fileInput = document.getElementById('article-editor-upload-img');
        if (fileInput) {
          fileInput.click();
        }
      }
      function onEditorImageFileChosen(e) {
        var files = e.target && e.target.files;
        if (!files || !files.length || !articleEditorTextarea) return;
        var list = [];
        for (var i = 0; i < files.length; i++) {
          var f = files[i];
          var isImage = (f.type && f.type.match(/^image\//)) || /\.(png|jpe?g|gif|webp|bmp)$/i.test(f.name || '');
          if (isImage) list.push(f);
        }
        if (list.length === 0) {
          e.target.value = '';
          alert('æœªé€‰ä¸­æœ‰æ•ˆå›¾ç‰‡ï¼Œè¯·é€‰æ‹© PNG/JPG/GIF/WebP ç­‰å›¾ç‰‡æ–‡ä»¶ã€‚');
          return;
        }
        var articleId = currentArticleIdForEditor;
        if (!articleId) {
          var hash = (window.location.hash || '').replace(/^#/, '');
          articleId = (hash.indexOf('article/') === 0 && hash.indexOf('/edit') > 0) ? hash.slice(8, hash.indexOf('/edit')) : (hash.indexOf('article/') === 0 ? hash.slice(8) : '1');
        }
        var index = 0;
        var htmlParts = [];
        var failed = [];
        function readNext() {
          if (index >= list.length) {
            if (htmlParts.length) {
              insertAtCursor(articleEditorTextarea, htmlParts.join(''), '');
              var msg = 'å·²æ’å…¥ ' + htmlParts.length + ' å¼ å›¾ç‰‡ã€‚';
              if (failed.length) msg += '\nä»¥ä¸‹æ–‡ä»¶è¯»å–å¤±è´¥ï¼š' + failed.join('ã€');
              alert(msg);
            } else if (failed.length) {
              alert('å›¾ç‰‡è¯»å–å¤±è´¥ï¼š' + failed.join('ã€'));
            }
            e.target.value = '';
            return;
          }
          var file = list[index];
          var id = 'img_' + Date.now() + '_' + index + '_' + Math.random().toString(36).slice(2);
          var filename = (file.name || 'å›¾ç‰‡' + (index + 1)).replace(/"/g, '&quot;');
          var reader = new FileReader();
          reader.onload = function (ev) {
            var dataUrl = ev.target && ev.target.result;
            if (dataUrl) {
              currentEditorImgMap[id] = { dataUrl: dataUrl, filename: file.name || ('å›¾ç‰‡' + (index + 1)) };
              htmlParts.push('<p><img data-img-id="' + id + '" src="[å›¾ç‰‡: ' + filename + ']" alt="' + filename + '"></p>');
            }
            index++;
            readNext();
          };
          reader.onerror = function () {
            failed.push(file.name || ('ç¬¬' + (index + 1) + 'ä¸ªæ–‡ä»¶'));
            index++;
            readNext();
          };
          reader.readAsDataURL(file);
        }
        readNext();
      }
      var uploadImgInput = document.getElementById('article-editor-upload-img');
      if (uploadImgInput) uploadImgInput.addEventListener('change', onEditorImageFileChosen);
      function onEditorInsertVideo() {
        var fileInput = document.getElementById('article-editor-upload-video');
        if (fileInput) fileInput.click();
      }
      function onEditorVideoFileChosen(e) {
        var file = e.target && e.target.files && e.target.files[0];
        if (!file || !articleEditorTextarea) { e.target.value = ''; return; }
        var isVideo = (file.type && file.type.match(/^video\//)) || /\.(mp4|webm|ogg|mov|avi|mkv)$/i.test(file.name || '');
        if (!isVideo) {
          e.target.value = '';
          alert('è¯·é€‰æ‹©è§†é¢‘æ–‡ä»¶ï¼ˆå¦‚ MP4ã€WebMã€OGG ç­‰ï¼‰ã€‚');
          return;
        }
        if (file.size > 20 * 1024 * 1024) {
          e.target.value = '';
          alert('è§†é¢‘å»ºè®®ä¸è¶…è¿‡ 20MBï¼Œè¿‡å¤§å¯èƒ½æ— æ³•ä¿å­˜æˆ–å¯¼è‡´é¡µé¢å¡é¡¿ã€‚');
          return;
        }
        var id = 'video_' + Date.now() + '_' + Math.random().toString(36).slice(2);
        var filename = (file.name || 'è§†é¢‘').replace(/"/g, '&quot;');
        var reader = new FileReader();
        reader.onload = function (ev) {
          var dataUrl = ev.target && ev.target.result;
          if (dataUrl) {
            currentEditorVideoMap[id] = { dataUrl: dataUrl, filename: file.name || 'è§†é¢‘' };
            insertAtCursor(articleEditorTextarea, '<p><video data-video-id="' + id + '" src="[è§†é¢‘: ' + filename + ']" controls></video></p>', '');
            alert('å·²æ’å…¥è§†é¢‘ï¼Œä¿å­˜æ–‡ç« åç”Ÿæ•ˆã€‚');
          }
          e.target.value = '';
        };
        reader.onerror = function () {
          alert('è§†é¢‘è¯»å–å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚');
          e.target.value = '';
        };
        reader.readAsDataURL(file);
      }
      var uploadVideoInput = document.getElementById('article-editor-upload-video');
      if (uploadVideoInput) uploadVideoInput.addEventListener('change', onEditorVideoFileChosen);
      function onEditorInsertH3() {
        insertAtCursor(articleEditorTextarea, '<h3>', '</h3>');
      }
      var btnP = document.getElementById('article-editor-insert-p');
      var btnImg = document.getElementById('article-editor-insert-img');
      var btnVideo = document.getElementById('article-editor-insert-video');
      var btnH3 = document.getElementById('article-editor-insert-h3');
      if (btnP) btnP.addEventListener('click', onEditorInsertP);
      if (btnImg) btnImg.addEventListener('click', onEditorInsertImg);
      if (btnVideo) btnVideo.addEventListener('click', onEditorInsertVideo);
      if (btnH3) btnH3.addEventListener('click', onEditorInsertH3);

      var currentEditorImgMap = {};
      var currentEditorVideoMap = {};
      var currentArticleIdForEditor = null;
      function getArticleImageMap(id) {
        try {
          var raw = localStorage.getItem('article_img_map_' + id);
          if (raw) return JSON.parse(raw);
        } catch (e) {}
        return {};
      }
      function setArticleImageMap(id, map) {
        try {
          localStorage.setItem('article_img_map_' + id, JSON.stringify(map));
        } catch (e) {}
      }
      function getArticleVideoMap(id) {
        try {
          var raw = localStorage.getItem('article_video_map_' + id);
          if (raw) return JSON.parse(raw);
        } catch (e) {}
        return {};
      }
      function setArticleVideoMap(id, map) {
        try {
          localStorage.setItem('article_video_map_' + id, JSON.stringify(map));
        } catch (e) {}
      }
      function replaceOneImg(_, pre, id, mid, post, map, forDisplay) {
        var item = map[id];
        var src = (item && item.dataUrl) ? item.dataUrl : '';
        if (forDisplay && !src) return '<span class="article-missing-img">[å›¾ç‰‡ç¼ºå¤±]</span>';
        return '<img' + pre + mid + ' src="' + src.replace(/"/g, '&quot;') + '" loading="lazy"' + post + '>';
      }
      function replaceOneVideo(_, pre, id, mid, post, map, forDisplay) {
        var item = map[id];
        var src = (item && item.dataUrl) ? item.dataUrl : '';
        if (forDisplay && !src) return '<span class="article-missing-video">[è§†é¢‘ç¼ºå¤±]</span>';
        return '<video' + pre + mid + ' src="' + src.replace(/"/g, '&quot;') + '"' + post + '>';
      }
      function expandContentForSave(collapsedHtml, imgMap, videoMap) {
        if (!collapsedHtml) return collapsedHtml || '';
        var map = imgMap || {};
        function replaceOneImg_(_, pre, id, mid, post) { return replaceOneImg(_, pre, id, mid, post, map, false); }
        var r = collapsedHtml.replace(/<img([^>]*?)data-img-id="([^"]+)"([^>]*?)src="\[(?:å›¾ç‰‡|Image):[^"]*\]"([^>]*)>/gi, replaceOneImg_);
        r = r.replace(/<img([^>]*?)src="\[(?:å›¾ç‰‡|Image):[^"]*\]"([^>]*?)data-img-id="([^"]+)"([^>]*)>/gi, function (_, pre, mid, id, post) {
          return replaceOneImg_(_, pre, id, mid, post);
        });
        var vmap = videoMap || {};
        function replaceOneVideo_(_, pre, id, mid, post) { return replaceOneVideo(_, pre, id, mid, post, vmap, false); }
        r = r.replace(/<video([^>]*?)data-video-id="([^"]+)"([^>]*?)src="\[(?:è§†é¢‘|Video):[^"]*\]"([^>]*)>/gi, replaceOneVideo_);
        r = r.replace(/<video([^>]*?)src="\[(?:è§†é¢‘|Video):[^"]*\]"([^>]*?)data-video-id="([^"]+)"([^>]*)>/gi, function (_, pre, mid, id, post) {
          return replaceOneVideo_(_, pre, id, mid, post);
        });
        return r;
      }
      function expandContentForDisplay(html, imgMap, videoMap) {
        if (!html) return html || '';
        var m = imgMap || {};
        function replaceOneImg_(_, pre, id, mid, post) { return replaceOneImg(_, pre, id, mid, post, m, true); }
        var r = html.replace(/<img([^>]*?)data-img-id="([^"]+)"([^>]*?)src="\[(?:å›¾ç‰‡|Image):[^"]*\]"([^>]*)>/gi, replaceOneImg_);
        r = r.replace(/<img([^>]*?)src="\[(?:å›¾ç‰‡|Image):[^"]*\]"([^>]*?)data-img-id="([^"]+)"([^>]*)>/gi, function (_, pre, mid, id, post) {
          return replaceOneImg_(_, pre, id, mid, post);
        });
        r = r.replace(/<img[^>]*?src="\[(?:å›¾ç‰‡|Image):[^"]*\]"[^>]*>/gi, '<span class="article-missing-img">[å›¾ç‰‡ç¼ºå¤±]</span>');
        var vm = videoMap || {};
        function replaceOneVideo_(_, pre, id, mid, post) { return replaceOneVideo(_, pre, id, mid, post, vm, true); }
        r = r.replace(/<video([^>]*?)data-video-id="([^"]+)"([^>]*?)src="\[(?:è§†é¢‘|Video):[^"]*\]"([^>]*)>/gi, replaceOneVideo_);
        r = r.replace(/<video([^>]*?)src="\[(?:è§†é¢‘|Video):[^"]*\]"([^>]*?)data-video-id="([^"]+)"([^>]*)>/gi, function (_, pre, mid, id, post) {
          return replaceOneVideo_(_, pre, id, mid, post);
        });
        r = r.replace(/<video[^>]*?src="\[(?:è§†é¢‘|Video):[^"]*\]"[^>]*>/gi, '<span class="article-missing-video">[è§†é¢‘ç¼ºå¤±]</span>');
        return r;
      }
      function collapseContentForEditor(expandedHtml, articleId, imgMapOut, videoMapOut) {
        var map = imgMapOut || {};
        var vmap = videoMapOut || {};
        var count = 0;
        var out = expandedHtml.replace(/<img\s+([^>]*?)src="(data:image\/[^"]+)"([^>]*)>/gi, function (_, before, dataUrl, after) {
          count++;
          var id = 'img_' + Date.now() + '_' + count + '_' + Math.random().toString(36).slice(2);
          map[id] = { dataUrl: dataUrl, filename: 'å›¾ç‰‡' + count };
          return '<img ' + before + 'data-img-id="' + id + '" src="[å›¾ç‰‡: å›¾ç‰‡' + count + ']"' + after + '>';
        });
        var vcount = 0;
        out = out.replace(/<video\s+([^>]*?)src="(data:video\/[^"]+)"([^>]*)>/gi, function (_, before, dataUrl, after) {
          vcount++;
          var id = 'video_' + Date.now() + '_' + vcount + '_' + Math.random().toString(36).slice(2);
          vmap[id] = { dataUrl: dataUrl, filename: 'è§†é¢‘' + vcount };
          return '<video ' + before + 'data-video-id="' + id + '" src="[è§†é¢‘: è§†é¢‘' + vcount + ']"' + after + '>';
        });
        if (!videoMapOut) setArticleVideoMap(articleId, vmap);
        if (!imgMapOut) setArticleImageMap(articleId, map);
        return out;
      }
      function getArticleContent(id) {
        try {
          var saved = localStorage.getItem('article_content_' + id);
          if (saved !== null && saved !== '') return saved;
        } catch (e) {}
        var a = ARTICLE_LIST && ARTICLE_LIST.find(function (item) { return String(item.id) === String(id); });
        return (a && a.content) ? a.content : '';
      }

      function renderArticleList() {
        if (!articleListEl || !ARTICLE_LIST || !ARTICLE_LIST.length) return;
        articleListEl.innerHTML = ARTICLE_LIST.map(function (a, i) {
          var id = a.id || (i + 1);
          var alt = (a.title || 'Article').replace(/"/g, '&quot;');
          var title = (a.title || '').replace(/</g, '&lt;').replace(/"/g, '&quot;');
          var excerpt = (a.excerpt || '').replace(/</g, '&lt;').replace(/"/g, '&quot;');
          var category = (a.category || 'å“ç‰Œ / ç­–ç•¥').replace(/</g, '&lt;').replace(/"/g, '&quot;');
          var num = (i + 1).toString();
          if (num.length < 2) num = '0' + num;
          var total = (ARTICLE_LIST.length).toString();
          if (total.length < 2) total = '0' + total;
          var mobileImg = 'article/m_article_' + (i + 1) + '.jpg';
          return '<li class="article-item">' +
            '<div class="article-item-inner">' +
            '<a href="#article/' + id + '" class="article-item-link">' +
            '<div class="article-item-card">' +
            '<div class="article-item-left">' +
            '<span class="article-item-tag">' +
            '<span class="article-item-tag-num">' + num + ' / ' + total + '</span>' +
            '<span class="article-item-tag-sep">|</span>' +
            '<span class="article-item-tag-cat">' + category + '</span>' +
            '</span>' +
            '<div class="article-item-content">' +
            '<h3 class="article-item-title">' + title + '</h3>' +
            '<p class="article-item-excerpt">' + excerpt + '</p>' +
            '<span class="article-item-cta">æŸ¥çœ‹è¯¦æƒ…</span>' +
            '</div></div>' +
            '<div class="article-item-right">' +
            '<div class="article-item-thumb"><img src="' + (a.thumb || '').replace(/"/g, '&quot;') + '" alt="' + alt + '" loading="lazy"></div>' +
            '</div>' +
            '<div class="article-item-mobile-img"><img src="' + mobileImg + '" alt="" loading="lazy"></div>' +
            '</div></a></div></li>';
        }).join('');
        if (articleListWrap) articleListWrap.classList.add('article-list-view');
      }

      function renderAiList() {
        if (!aiListEl || !AI_LIST || !AI_LIST.length) return;
        aiListEl.innerHTML = AI_LIST.map(function (a, i) {
          var id = a.id || (i + 1);
          var alt = (a.title || 'AI').replace(/"/g, '&quot;');
          var title = (a.title || '').replace(/</g, '&lt;').replace(/"/g, '&quot;');
          var excerpt = (a.excerpt || '').replace(/</g, '&lt;').replace(/"/g, '&quot;');
          var num = (i + 1).toString();
          if (num.length < 2) num = '0' + num;
          var total = (AI_LIST.length).toString();
          if (total.length < 2) total = '0' + total;
          var href = (a.link != null && a.link !== '') ? a.link : '#';
          return '<li class="article-item">' +
            '<div class="article-item-inner">' +
            '<a href="' + href.replace(/"/g, '&quot;') + '" class="article-item-link">' +
            '<div class="article-item-card">' +
            '<div class="article-item-left">' +
            '<div class="article-item-tag-row">' +
            '<span class="article-item-tag">' +
            '<span class="article-item-tag-num">' + num + ' / ' + total + '</span>' +
            '<span class="article-item-tag-sep">|</span>' +
            '<span class="article-item-tag-cat">å¼€æºæ’ä»¶</span>' +
            '</span>' +
            '<img src="AI/icon128.png" alt="" class="article-item-ai-icon" loading="lazy">' +
            '</div>' +
            '<div class="article-item-content">' +
            '<h3 class="article-item-title">' + title + '</h3>' +
            '<p class="article-item-excerpt">' + excerpt + '</p>' +
            '<span class="article-item-cta">æŸ¥çœ‹Github</span>' +
            '</div></div></div></a></div></li>';
        }).join('');
        if (aiListWrap) aiListWrap.classList.add('article-list-view');
      }

      function showArticleList() {
        document.body.classList.add('article-list-view');
        document.documentElement.classList.add('article-list-view');
        if (sections.article) {
          sections.article.classList.remove('article-view-detail');
          sections.article.classList.add('article-showing-list');
        }
        if (articleListWrap) articleListWrap.classList.remove('is-hidden');
        if (articleDetailWrap) { articleDetailWrap.classList.remove('is-visible'); articleDetailWrap.setAttribute('aria-hidden', 'true'); }
        if (articleEditorWrap) { articleEditorWrap.classList.remove('is-visible'); articleEditorWrap.setAttribute('aria-hidden', 'true'); }
      }

      function showArticleDetail(id) {
        document.body.classList.remove('article-list-view');
        document.documentElement.classList.remove('article-list-view');
        var a = ARTICLE_LIST && ARTICLE_LIST.find(function (item) { return String(item.id) === String(id); });
        if (!a) { showArticleList(); return; }
        if (sections.article) {
          sections.article.classList.add('article-view-detail');
          sections.article.classList.remove('article-showing-list');
        }
        if (articleListWrap) articleListWrap.classList.add('is-hidden');
        if (articleEditorWrap) { articleEditorWrap.classList.remove('is-visible'); articleEditorWrap.setAttribute('aria-hidden', 'true'); }
        if (articleDetailWrap) {
          articleDetailWrap.classList.add('is-visible');
          articleDetailWrap.setAttribute('aria-hidden', 'false');
          if (articleDetailTitle) articleDetailTitle.textContent = a.title || '';
          if (articleDetailMeta) articleDetailMeta.textContent = a.date || '';
          if (articleDetailContent) articleDetailContent.innerHTML = expandContentForDisplay(getArticleContent(id), getArticleImageMap(id), getArticleVideoMap(id));
          if (articleDetailEditLink) { articleDetailEditLink.href = '#article/' + id + '/edit'; articleDetailEditLink.style.display = 'inline-block'; }
        }
        if (sections.article) sections.article.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      function showArticleEditor(id) {
        var a = ARTICLE_LIST && ARTICLE_LIST.find(function (item) { return String(item.id) === String(id); });
        if (!a) { showArticleList(); return; }
        if (sections.article) sections.article.classList.add('article-view-detail');
        if (articleListWrap) articleListWrap.classList.add('is-hidden');
        if (articleDetailWrap) { articleDetailWrap.classList.remove('is-visible'); articleDetailWrap.setAttribute('aria-hidden', 'true'); }
        if (articleEditorWrap) {
          articleEditorWrap.classList.add('is-visible');
          articleEditorWrap.setAttribute('aria-hidden', 'false');
          if (articleEditorTitle) articleEditorTitle.textContent = a.title || '';
          currentArticleIdForEditor = id;
          currentEditorImgMap = {};
          currentEditorVideoMap = {};
          if (articleEditorTextarea) articleEditorTextarea.value = collapseContentForEditor(getArticleContent(id), id, currentEditorImgMap, currentEditorVideoMap);
        }
        if (sections.article) sections.article.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      renderArticleList();

      function showHome() {
        document.body.setAttribute('data-tab', 'home');
        setNavActive('hero');
      }
      function showAiList() {
        document.body.classList.add('ai-list-view');
        document.documentElement.classList.add('ai-list-view');
        if (sections.ai) sections.ai.classList.add('ai-showing-list');
        renderAiList();
      }

      function showOnly(key) {
        if (key !== 'article') {
          document.body.classList.remove('article-list-view');
          document.documentElement.classList.remove('article-list-view');
        }
        if (key !== 'ai') {
          document.body.classList.remove('ai-list-view');
          document.documentElement.classList.remove('ai-list-view');
          if (sections.ai) sections.ai.classList.remove('ai-showing-list');
        }
        document.body.setAttribute('data-tab', key);
        setNavActive(key);
        if (!document.body.classList.contains('swipe-mode')) {
          window.scrollTo(0, 0);
        }
        var pageKey = (key === 'home') ? 'hero' : key;
        resetPageScrollToTop(pageKey);
      }

      var navBgByKey = { hero: 'dark', projects: 'white', ai: 'white', article: 'white', about: 'dark' };

      function setNavActive(key) {
        var navKey = (key === 'home') ? 'hero' : key;
        var navLinks = document.querySelectorAll('#main-nav a[href^="#"]');
        navLinks.forEach(function (a) { a.classList.remove('nav-active'); });
        navLinks.forEach(function (a) {
          var href = (a.getAttribute('href') || '').replace('#', '').split('/')[0];
          var isActive = (navKey === 'hero') ? (href === 'hero' || href === '') : (href === navKey);
          if (isActive) a.classList.add('nav-active');
        });
        if (key === 'about' || key === 'hero' || key === 'home') {
          updateNavBgByScroll();
        } else {
          var bg = navBgByKey[navKey] || 'white';
          document.body.classList.remove('nav-bg-dark', 'nav-bg-white');
          document.body.classList.add('nav-bg-' + bg);
        }
        if (document.body.classList.contains('swipe-mode')) {
          var activeLink = document.querySelector('#main-nav a.nav-active');
          if (activeLink) activeLink.scrollIntoView({ inline: 'center', block: 'nearest', behavior: 'smooth' });
        }
      }

      function updateNavBgByScroll() {
        var activeLink = document.querySelector('#main-nav a.nav-active');
        var href = activeLink ? (activeLink.getAttribute('href') || '').replace('#', '') : '';
        var sectionId = (href === 'hero' || href === '') ? 'hero' : href;
        var el = (sectionId === 'hero' || sectionId === 'about') ? document.getElementById(sectionId) : null;
        if (!el) {
          document.body.classList.remove('nav-bg-dark', 'nav-bg-white');
          document.body.classList.add('nav-bg-' + (navBgByKey[sectionId] || 'white'));
          return;
        }
        var rect = el.getBoundingClientRect();
        var inWhiteZone = rect.top < -rect.height * 0.4;
        var navIsWhite = nav && nav.classList.contains('nav-scrolled');
        var useBlueText = inWhiteZone || navIsWhite;
        document.body.classList.remove('nav-bg-dark', 'nav-bg-white');
        document.body.classList.add(useBlueText ? 'nav-bg-white' : 'nav-bg-dark');
      }

      var tabOverlay = document.getElementById('tab-transition-overlay');
      var TAB_TRANSITION_DURATION = 220;

      function transitionToTab(targetHash, callback) {
        targetHash = (targetHash === 'hero' || targetHash === '') ? '' : targetHash;
        window.scrollTo(0, 0);
        window.location.hash = targetHash || 'hero';
        if (callback) callback();
        /* PC ç«¯ä¸å†ä½¿ç”¨ overlay æ¸éšæ¸ç°ï¼Œç›´æ¥åˆ‡æ¢ */
      }

      var SWIPE_PAGE_IDS = ['hero', 'projects', 'article', 'ai', 'about'];
      var swipeWrapperEl = null;
      var swipeScrollListener = null;
      var swipeUpdatingFromScroll = false;
      var isClickingTab = false;

      function resetPageScrollToTop(pageId) {
        if (!pageId || pageId === 'hero') pageId = 'hero';
        var page = document.getElementById(pageId);
        if (page) page.scrollTop = 0;
        if (pageId === 'article') {
          var wrap = document.getElementById('article-list-wrap');
          if (wrap) wrap.scrollTop = 0;
        }
        if (pageId === 'ai') {
          var list = document.getElementById('ai-list');
          if (list) list.scrollTop = 0;
        }
      }

      document.querySelectorAll('#main-nav a').forEach(function (a) {
        a.addEventListener('click', function (e) {
          var id = (a.getAttribute('href') || '').replace('#', '');
          if (document.body.classList.contains('swipe-mode') && swipeWrapperEl) {
            e.preventDefault();
            if (!id || id === 'hero') id = 'hero';
            var idx = SWIPE_PAGE_IDS.indexOf(id);
            if (idx >= 0) {
              isClickingTab = true;
              resetPageScrollToTop(id);
              setNavActive(id);
              var pageWidth = swipeWrapperEl.getBoundingClientRect().width;
              swipeWrapperEl.scrollTo({ left: idx * pageWidth, behavior: 'smooth' });
              window.location.hash = (id === 'hero' ? '' : id);
              setTimeout(function () { isClickingTab = false; }, 520);
            }
            return;
          }
          if (!id || id === 'hero') {
            e.preventDefault();
            transitionToTab('', function () {
              showHome();
              if (sections.hero) sections.hero.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
            return;
          }
          if (['projects', 'ai', 'article', 'about'].indexOf(id) >= 0) {
            e.preventDefault();
            transitionToTab(id, function () {
              var el = sections[id];
              if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
          }
        });
      });

      function syncTabFromHash() {
        if (swipeUpdatingFromScroll) return;
        var hash = (window.location.hash || '').replace('#', '');
        if (hash === 'about') { showOnly('about'); }
        else if (hash === 'projects') { showOnly('projects'); }
        else if (hash === 'ai') { showOnly('ai'); showAiList(); }
        else if (hash === 'article') { showOnly('article'); showArticleList(); }
        else if (hash.indexOf('article/') === 0) {
          var rest = hash.slice(8);
          var slash = rest.indexOf('/');
          var articleId = slash >= 0 ? rest.slice(0, slash) : rest;
          var isEdit = slash >= 0 && rest.slice(slash) === '/edit';
          showOnly('article');
          if (isEdit) showArticleEditor(articleId);
          else showArticleDetail(articleId);
        }
        else { showHome(); }
        var tab = (hash === 'article' || hash.indexOf('article/') === 0) ? 'article' : (hash || 'hero');
        setNavActive(tab);
        if (hash === 'about' || hash === '' || hash === 'hero') requestAnimationFrame(updateNavBgByScroll);
      }

      if (articleEditorSave) {
        articleEditorSave.addEventListener('click', function () {
          var hash = (window.location.hash || '').replace('#', '');
          if (hash.indexOf('article/') !== 0) return;
          var rest = hash.slice(8);
          var slash = rest.indexOf('/');
          var id = slash >= 0 ? rest.slice(0, slash) : rest;
          if (!id) return;
          try {
            var raw = articleEditorTextarea ? articleEditorTextarea.value : '';
            var expanded = expandContentForSave(raw, currentEditorImgMap, currentEditorVideoMap);
            localStorage.setItem('article_content_' + id, expanded);
            window.location.hash = 'article/' + id;
          } catch (e) {
            var isQuota = (e && (e.name === 'QuotaExceededError' || e.code === 22));
            if (isQuota) {
              var approx = (expanded.length * 2 / 1024 / 1024).toFixed(2);
              alert('ä¿å­˜å¤±è´¥ï¼šå†…å®¹è¿‡å¤§ï¼ˆçº¦ ' + approx + ' MBï¼Œè¶…è¿‡ 5MB é™åˆ¶ï¼‰ã€‚\n\nå»ºè®®ï¼š\n1. å‡å°‘æœ¬ç¯‡æ–‡ç« çš„å›¾ç‰‡æ•°é‡ï¼›\n2. æˆ–å…ˆå‹ç¼©å›¾ç‰‡å†ä¸Šä¼ ï¼›\n3. æˆ–æ‹†æˆå¤šç¯‡æ–‡ç« ã€‚\n\nå½“å‰å†…å®¹æœªä¿å­˜ï¼Œè¯·åˆ æ‰éƒ¨åˆ†å›¾ç‰‡åé‡è¯•ã€‚');
            } else {
              alert('ä¿å­˜å¤±è´¥ï¼š' + (e && e.message ? e.message : 'æœªçŸ¥é”™è¯¯'));
            }
          }
        });
      }
      if (articleEditorBack) articleEditorBack.addEventListener('click', function (e) { e.preventDefault(); window.location.hash = 'article'; });
      if (articleEditorCancel) articleEditorCancel.addEventListener('click', function (e) { e.preventDefault(); var h = (window.location.hash || '').replace('#', ''); if (h.indexOf('article/') === 0) { var r = h.slice(8), s = r.indexOf('/'); window.location.hash = 'article/' + (s >= 0 ? r.slice(0, s) : r); } else window.location.hash = 'article'; });
      syncTabFromHash();
      window.addEventListener('hashchange', syncTabFromHash);

      (function initSwipeTabs() {
        if (!('ontouchstart' in window)) return;
        var TAB_HASHES = ['', 'projects', 'article', 'ai', 'about'];
        var SWIPE_MIN = 60;
        var startX = 0;
        function getCurrentTabIndex() {
          var hash = (window.location.hash || '').replace('#', '');
          if (hash === '' || hash === 'hero') return 0;
          if (hash === 'projects') return 1;
          if (hash === 'article' || hash.indexOf('article/') === 0) return 2;
          if (hash === 'ai') return 3;
          if (hash === 'about') return 4;
          return 0;
        }
        function goToTabIndex(index) {
          var h = TAB_HASHES[index] || 'hero';
          transitionToTab(h === 'hero' ? '' : h);
        }
        document.addEventListener('touchstart', function (e) {
          if (e.touches.length) startX = e.touches[0].clientX;
        }, { passive: true });
        document.addEventListener('touchend', function (e) {
          if (document.body.classList.contains('swipe-mode')) return;
          if (!e.changedTouches || !e.changedTouches.length) return;
          var endX = e.changedTouches[0].clientX;
          var delta = endX - startX;
          var cur = getCurrentTabIndex();
          if (delta > SWIPE_MIN) {
            var prev = cur - 1;
            if (prev < 0) prev = TAB_HASHES.length - 1;
            goToTabIndex(prev);
          } else if (delta < -SWIPE_MIN) {
            var next = (cur + 1) % TAB_HASHES.length;
            goToTabIndex(next);
          }
        }, { passive: true });
      })();

      function enableSwipeMode() {
        if (swipeWrapperEl) return;
        var pageWrap = document.querySelector('.page-wrap');
        var lightbox = document.getElementById('lightbox');
        if (!pageWrap || !lightbox) return;
        var hero = document.getElementById('hero');
        var projects = document.getElementById('projects');
        var article = document.getElementById('article');
        var ai = document.getElementById('ai');
        var about = document.getElementById('about');
        if (!hero || !projects || !article || !ai || !about) return;
        var wrapper = document.createElement('div');
        wrapper.className = 'swipe-wrapper';
        wrapper.appendChild(hero);
        wrapper.appendChild(projects);
        wrapper.appendChild(article);
        wrapper.appendChild(ai);
        wrapper.appendChild(about);
        [hero, projects, article, ai, about].forEach(function (el) { el.classList.add('swipe-page'); });
        pageWrap.insertBefore(wrapper, lightbox);
        swipeWrapperEl = wrapper;

        var SWIPE_DELTA_THRESHOLD = 50;
        var SWIPE_DEBOUNCE_MS = 400;
        var lastSwipeTime = 0;
        var touchStartX = 0;
        var touchStartY = 0;
        var touchStartScroll = 0;
        var touchStartIndex = 0;
        var touchIsHorizontal = null;

        function scrollToPage(index) {
          if (!swipeWrapperEl) return;
          var w = swipeWrapperEl.getBoundingClientRect().width;
          index = Math.max(0, Math.min(index, SWIPE_PAGE_IDS.length - 1));
          var key = SWIPE_PAGE_IDS[index];
          resetPageScrollToTop(key);
          swipeWrapperEl.scrollTo({ left: index * w, behavior: 'smooth' });
          var tabKey = (key === 'hero') ? 'home' : key;
          document.body.setAttribute('data-tab', tabKey);
          setNavActive(key);
          if (key === 'article') showArticleList();
          if (key === 'ai') showAiList();
          swipeUpdatingFromScroll = true;
          window.location.hash = (key === 'hero' ? '' : key);
          swipeUpdatingFromScroll = false;
        }

        var lastSwipePageIndex = -1;
        function updateTabFromScroll() {
          if (!swipeWrapperEl) return;
          if (isClickingTab) return;
          var w = swipeWrapperEl.getBoundingClientRect().width;
          var scrollLeft = swipeWrapperEl.scrollLeft;
          var maxScroll = Math.max(0, swipeWrapperEl.scrollWidth - w);
          var index = scrollLeft <= 1 ? 0 : (scrollLeft >= maxScroll - 1 ? SWIPE_PAGE_IDS.length - 1 : Math.floor((scrollLeft + w * 0.5) / w));
          index = Math.max(0, Math.min(index, SWIPE_PAGE_IDS.length - 1));
          var key = SWIPE_PAGE_IDS[index];
          if (index !== lastSwipePageIndex) {
            resetPageScrollToTop(key);
            lastSwipePageIndex = index;
          }
          var targetLeft = index * w;
          if (Math.abs(swipeWrapperEl.scrollLeft - targetLeft) > 2) {
            swipeWrapperEl.scrollTo({ left: targetLeft, behavior: 'smooth' });
          }
          var tabKey = (key === 'hero') ? 'home' : key;
          document.body.setAttribute('data-tab', tabKey);
          setNavActive(key);
          if (key === 'article') showArticleList();
          if (key === 'ai') showAiList();
          swipeUpdatingFromScroll = true;
          window.location.hash = (key === 'hero' ? '' : key);
          swipeUpdatingFromScroll = false;
        }

        function onTouchStart(e) {
          if (!e.touches || !e.touches.length) return;
          if (Date.now() - lastSwipeTime < SWIPE_DEBOUNCE_MS) return;
          var w = wrapper.getBoundingClientRect().width;
          touchStartX = e.touches[0].clientX;
          touchStartY = e.touches[0].clientY;
          touchStartScroll = wrapper.scrollLeft;
          touchStartIndex = Math.round(touchStartScroll / w);
          touchStartIndex = Math.max(0, Math.min(touchStartIndex, SWIPE_PAGE_IDS.length - 1));
          touchIsHorizontal = null;
        }
        function onTouchMove(e) {
          if (!e.touches || !e.touches.length) return;
          var deltaX = e.touches[0].clientX - touchStartX;
          var deltaY = e.touches[0].clientY - touchStartY;
          if (touchIsHorizontal === null) touchIsHorizontal = Math.abs(deltaX) > Math.abs(deltaY);
          if (!touchIsHorizontal) return;
          e.preventDefault();
          var w = wrapper.getBoundingClientRect().width;
          var targetScroll = touchStartScroll - deltaX;
          var minScroll = Math.max(0, (touchStartIndex - 1) * w);
          var maxScroll = Math.min(wrapper.scrollWidth - w, (touchStartIndex + 1) * w);
          wrapper.scrollLeft = Math.max(minScroll, Math.min(maxScroll, targetScroll));
        }
        function onTouchEnd(e) {
          if (!e.changedTouches || !e.changedTouches.length) return;
          if (!touchIsHorizontal) return;
          var endX = e.changedTouches[0].clientX;
          var deltaX = endX - touchStartX;
          var w = wrapper.getBoundingClientRect().width;
          var threshold = Math.min(SWIPE_DELTA_THRESHOLD, w * 0.2);
          var targetIndex = touchStartIndex;
          if (deltaX > threshold) targetIndex = touchStartIndex - 1;
          else if (deltaX < -threshold) targetIndex = touchStartIndex + 1;
          scrollToPage(targetIndex);
          lastSwipeTime = Date.now();
        }

        wrapper._swipeHandlers = { onTouchStart: onTouchStart, onTouchMove: onTouchMove, onTouchEnd: onTouchEnd };
        wrapper.addEventListener('touchstart', onTouchStart, { passive: true });
        wrapper.addEventListener('touchmove', onTouchMove, { passive: false });
        wrapper.addEventListener('touchend', onTouchEnd, { passive: true });

        function onWheel(e) {
          if (Math.abs(e.deltaX) < Math.abs(e.deltaY)) return;
          e.preventDefault();
          var w = wrapper.getBoundingClientRect().width;
          if (Date.now() - lastSwipeTime < SWIPE_DEBOUNCE_MS) return;
          var curIndex = Math.round(wrapper.scrollLeft / w);
          curIndex = Math.max(0, Math.min(curIndex, SWIPE_PAGE_IDS.length - 1));
          var threshold = 10;
          if (e.deltaX > threshold) curIndex = Math.max(0, curIndex - 1);
          else if (e.deltaX < -threshold) curIndex = Math.min(SWIPE_PAGE_IDS.length - 1, curIndex + 1);
          scrollToPage(curIndex);
          lastSwipeTime = Date.now();
        }
        wrapper._swipeHandlers.onWheel = onWheel;
        wrapper.addEventListener('wheel', onWheel, { passive: false });

        var scrollEndTimer = null;
        swipeScrollListener = function () {
          if (scrollEndTimer) clearTimeout(scrollEndTimer);
          scrollEndTimer = setTimeout(updateTabFromScroll, 200);
        };
        wrapper.addEventListener('scroll', swipeScrollListener, { passive: true });
        document.body.classList.add('swipe-mode');
        var hash = (window.location.hash || '').replace('#', '');
        if (hash.indexOf('article/') === 0) hash = 'article';
        if (!hash || hash === 'hero') hash = 'hero';
        var idx = SWIPE_PAGE_IDS.indexOf(hash);
        if (idx >= 0) {
          var pw = wrapper.getBoundingClientRect().width;
          wrapper.scrollTo({ left: idx * pw, behavior: 'auto' });
        }
        updateTabFromScroll();
      }

      function disableSwipeMode() {
        if (!swipeWrapperEl) return;
        var pageWrap = document.querySelector('.page-wrap');
        var lightbox = document.getElementById('lightbox');
        if (!pageWrap || !lightbox) return;
        var wrapper = swipeWrapperEl;
        if (swipeScrollListener) {
          wrapper.removeEventListener('scroll', swipeScrollListener);
          swipeScrollListener = null;
        }
        if (wrapper._swipeHandlers) {
          wrapper.removeEventListener('touchstart', wrapper._swipeHandlers.onTouchStart);
          wrapper.removeEventListener('touchmove', wrapper._swipeHandlers.onTouchMove);
          wrapper.removeEventListener('touchend', wrapper._swipeHandlers.onTouchEnd);
          wrapper.removeEventListener('wheel', wrapper._swipeHandlers.onWheel);
          delete wrapper._swipeHandlers;
        }
        var hero = document.getElementById('hero');
        var projects = document.getElementById('projects');
        var article = document.getElementById('article');
        var ai = document.getElementById('ai');
        var about = document.getElementById('about');
        [hero, projects, article, ai, about].forEach(function (el) { if (el) el.classList.remove('swipe-page'); });
        pageWrap.insertBefore(article, lightbox);
        pageWrap.insertBefore(ai, lightbox);
        pageWrap.insertBefore(projects, lightbox);
        pageWrap.insertBefore(hero, lightbox);
        pageWrap.appendChild(about);
        wrapper.parentNode.removeChild(wrapper);
        swipeWrapperEl = null;
        document.body.classList.remove('swipe-mode');
      }

      if (window.innerWidth < 768) enableSwipeMode();
      window.addEventListener('resize', function () {
        if (window.innerWidth < 768 && !swipeWrapperEl) enableSwipeMode();
        else if (window.innerWidth >= 768 && swipeWrapperEl) disableSwipeMode();
      });

      onScroll();
      var heroWrap = document.getElementById('hero-card-wrap');
      var peekButtons = heroWrap ? heroWrap.querySelectorAll('.peek-card') : [];

      function getWorkPoolFromGallery() {
        var imgs = document.querySelectorAll('#projects .works-gallery img');
        var srcs = [];
        for (var i = 0; i < imgs.length; i++) {
          var img = imgs[i];
          if (!img) continue;
          // ä¼˜å…ˆç”¨æµè§ˆå™¨å·²è§£æçš„åœ°å€ï¼ˆfile:// ä¸‹ Chrome èƒ½æ­£ç¡®åŠ è½½ï¼‰
          var url = (img.currentSrc || img.src || img.getAttribute('src') || '').trim();
          if (url) srcs.push(url);
        }
        var u = Array.from(new Set(srcs));
        return u.length ? u : (WORK_IMAGES ? WORK_IMAGES.slice() : []);
      }

      function pickRandomUnique(n) {
        var pool = getWorkPoolFromGallery().slice();
        var out = [];
        while (out.length < n && pool.length) {
          var idx = Math.floor(Math.random() * pool.length);
          out.push(pool.splice(idx, 1)[0]);
        }
        return out;
      }

      function preloadWorkImages() {
        var pool = getWorkPoolFromGallery();
        pool.forEach(function (src) {
          var im = new Image();
          im.src = src;
        });
      }
      preloadWorkImages();

      function applyPeekImages() {
        if (!peekButtons.length) return;
        var picks = pickRandomUnique(peekButtons.length);
        if (!picks.length) return;
        peekButtons.forEach(function (btn, i) {
          var src = picks[i] || picks[picks.length - 1];
          var imgEl = btn.querySelector('img');
          if (imgEl) imgEl.alt = 'Work preview';
          btn.dataset.src = src;
          btn.classList.remove('peek-loaded');
          btn.style.backgroundImage = '';
          var loader = new Image();
          loader.onload = function () {
            btn.style.backgroundImage = 'url("' + src.replace(/"/g, '%22') + '")';
            btn.classList.add('peek-loaded');
          };
          loader.onerror = function () { btn.classList.remove('peek-loaded'); };
          loader.src = src;
        });
      }

      applyPeekImages();
      setTimeout(applyPeekImages, 300);
      if (heroWrap) {
        var firstHoverLeaveDone = false;
        var firstHoverEnterDone = false;
        heroWrap.addEventListener('mouseenter', function () {
          if (!firstHoverEnterDone) {
            firstHoverEnterDone = true;
          } else {
            applyPeekImages();
          }
          heroWrap.classList.add('is-peeking');
        });
        heroWrap.addEventListener('mouseleave', function () {
          heroWrap.classList.remove('is-peeking');
          if (!firstHoverLeaveDone) {
            firstHoverLeaveDone = true;
            heroWrap.classList.remove('peek-revealing');
            heroWrap.classList.remove('peek-revealed');
          }
        });
        heroWrap.addEventListener('click', function () {
          heroWrap.classList.toggle('is-peeking');
        });
        setTimeout(function () {
          heroWrap.classList.add('peek-revealed');
          heroWrap.classList.add('peek-revealing');
        }, 400);
      }

      peekButtons.forEach(function (btn) {
        btn.addEventListener('click', function (e) {
          e.stopPropagation();
          var src = btn.dataset.src || (btn.querySelector('img') && btn.querySelector('img').src) || '';
          if (!src) return;
          openLightbox(src, 'Work preview');
        });
      });

    });
  </script>

  <section id="about">
    <div class="section-inner">
      <img src="avatar1.png" alt="Afu" class="about-avatar" loading="lazy">
      <div class="about-content">
        <p>Afu (Zhang Huafeng) | Senior Visual Designer & Design Manager</p>
        <p>Over 10 years of end-to-end design experience, formerly at Huawei and Tencent. Led visual upgrades and brand design for core products including Tencent Browser, Weishi, and Tencent Cloud official site; deeply involved in interaction and product modules, with full-cycle capability from visual execution to design management.</p>
        <p>Skilled at conveying brand warmth through visual language and solving business problems with design logic; rich hands-on experience in motion design and brand design.</p>
      </div>
    </div>
  </section>
  </div>

  <footer>
    <p>Â© 2025 Afu Â· Portfolio</p>
  </footer>
</body>
</html>
